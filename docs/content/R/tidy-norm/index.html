<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.296">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Josef Fruehwald">
<meta name="dcterms.date" content="2022-10-20">
<meta name="description" content="A tutorial on how to normalize vowel formant measurments in R using the tidyverse">

<title>LingMethodsHub - How to normalize your vowels using the tidyverse</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../content/R/animated_vowel_plots_tutorial/index.html" rel="next">
<link href="../../../content/R/vowel-plots-tutorial/index.html" rel="prev">
<script src="../../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ES98D09K0F"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ES98D09K0F', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"express",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script> 
  
<style>html{ scroll-behavior: smooth; }</style>
<script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean",
  "openSidebar": false,
  "showHighlights": "never"
}
</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible">

<link href="../../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="LingMethodsHub - How to normalize your vowels using the tidyverse">
<meta property="og:description" content="A tutorial on how to normalize vowel formant measurments in R using the tidyverse">
<meta property="og:image" content="https://lingmethodshub.github.io/content/R/tidy-norm/index_files/figure-html/fig-unnorm1-1.png">
<meta property="og:site-name" content="LingMethodsHub">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1152">
<meta name="twitter:title" content="LingMethodsHub - How to normalize your vowels using the tidyverse">
<meta name="twitter:description" content="A tutorial on how to normalize vowel formant measurments in R using the tidyverse">
<meta name="twitter:image" content="https://lingmethodshub.github.io/content/R/tidy-norm/index_files/figure-html/fig-unnorm1-1.png">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1152">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="How to normalize your vowels using the tidyverse">
<meta name="citation_author" content="Josef Fruehwald">
<meta name="citation_publication_date" content="2022-10-20">
<meta name="citation_cover_date" content="2022-10-20">
<meta name="citation_year" content="2022">
<meta name="citation_online_date" content="2022-10-20">
<meta name="citation_fulltext_html_url" content="https://lingmethodshub.github.io/content/R/tidy-norm">
<meta name="citation_doi" content="10.5281/zenodo.7232341">
<meta name="citation_language" content="en">
<meta name="citation_journal_title" content="Linguistics Methods Hub">
<meta name="citation_series_title" content="Linguistics Methods Hub">
<meta name="citation_reference" content="citation_title=A comparison of vowel normalization procedures for language variation research;,citation_author=Patti Adank;,citation_author=Roel Smits;,citation_author=Roeland Hout;,citation_publication_date=2004;,citation_cover_date=2004;,citation_year=2004;,citation_fulltext_html_url=http://link.aip.org/link/JASMAN/v116/i5/p3099/s1&amp;amp;amp;Agg=doi;,citation_issue=5;,citation_doi=10.1121/1.1795335;,citation_volume=116;,citation_journal_title=The Journal of the Acoustical Society of America;">
<meta name="citation_reference" content="citation_title=Order of Operations in Sociophonetic Analysis;,citation_author=Joseph A Stanley;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://repository.upenn.edu/pwpl/vol28/iss2/17;,citation_issue=2;,citation_volume=28;,citation_language=en;,citation_journal_title=Penn Working Papers in Linguistics;">
<meta name="citation_reference" content="citation_title=Vowels: Vowel manipulation, normalization, and plotting;,citation_author=Tyler Kendall;,citation_author=Erik R. Thomas;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://CRAN.R-project.org/package=vowels;">
<meta name="citation_reference" content="citation_title=Classification of russian vowels spoken by different listeners;,citation_author=Boris Lobanov;,citation_publication_date=1971;,citation_cover_date=1971;,citation_year=1971;,citation_volume=49;,citation_journal_title=Journal of the Acoustical Society of America;">
<meta name="citation_reference" content="citation_title=Phonetic feature systems for vowels.;,citation_author=Terrance Nearey;,citation_publication_date=1978;,citation_cover_date=1978;,citation_year=1978;,citation_fulltext_html_url=https://sites.ualberta.ca/~tnearey/Nearey1978_compressed.pdf;">
<meta name="citation_reference" content="citation_title=Evaluation of a technique for improving the mapping of multiple speakers’ vowel spaces in the F1 &nbsp; F2 plane;,citation_author=Dominic Watt;,citation_author=Anne Fabricius;,citation_publication_date=2002;,citation_cover_date=2002;,citation_year=2002;,citation_volume=9;,citation_language=en;,citation_journal_title=Leeds Working Papers in Linguistics and Phonetics;">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">LingMethodsHub</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../../index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../content/index.html" rel="" target="">
 <span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../content/contributing/index.html" rel="" target="">
 <span class="menu-text">Contributing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../people/index.html" rel="" target="">
 <span class="menu-text">People</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/LingMethodsHub/LingMethodsHub.github.io" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../content/R/index.html">R</a></li><li class="breadcrumb-item"><a href="../../../content/R/tidy-norm/index.html">How to normalize your vowels using the tidyverse</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../../index.html" class="sidebar-logo-link">
      <img src="../../../assets/logo.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorials</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../content/R/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Doing LVC with R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/lvc_r/010_lvcr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/lvc_r/020_lvcr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Your Data Into <em>R</em></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/lvc_r/030_lvcr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting to Know Your Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/lvc_r/040_lvcr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modifying Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/lvc_r/050_lvcr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Doing it all again, but <code>tidy</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/lvc_r/060_lvcr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Crosstabs: Counts, Proportions, and More</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/lvc_r/070_lvcr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Proportions for <code>ggplot2</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/lvc_r/080_lvcr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conditional Inference Trees</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/lvc_r/090_lvcr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Random Forests: The Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/lvc_r/110_lvcr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed-Efects Logistic Regression Analysis: Part 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/lvc_r/112_lvcr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed-Efects Logistic Regression Analysis: Part 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/lvc_r/114_lvcr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed-Efects Logistic Regression Analysis: Part 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/lvc_r/116_lvcr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed-Efects Logistic Regression Analysisː Part 4</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/vowel-plots-tutorial/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vowel Plots with <code>ggplot2</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/tidy-norm/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">How to normalize your vowels using the tidyverse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/R/animated_vowel_plots_tutorial/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualising Vowel Space Change with GAMMs</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../content/python/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/python/vowel-plotting-py/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vowel plotting in Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/python/speaker-diarization-for-linguistics/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Speaker Diarization for Linguistics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Praat</span></span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../content/tools/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/tools/mfa/mfa-tutorial/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Montreal Forced Aligner</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/tools/autovot/autovot-tutorial/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AutoVOT</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../content/cli/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Command Line Interfaces</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/cli/bash-shell-basics/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bash Shell Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/cli/keyboarding/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Keyboarding</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../content/windows/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Windows</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../content/windows/wsl/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Windows Subsystem for Linux</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/windows/wsl/00_installing_wsl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installation</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#lobanov-a.k.a.-z-scoring" id="toc-lobanov-a.k.a.-z-scoring" class="nav-link active" data-scroll-target="#lobanov-a.k.a.-z-scoring">Lobanov (a.k.a. z-scoring)</a></li>
  <li><a href="#nearey-2" id="toc-nearey-2" class="nav-link" data-scroll-target="#nearey-2">Nearey 2</a></li>
  <li><a href="#watt-fabricius" id="toc-watt-fabricius" class="nav-link" data-scroll-target="#watt-fabricius">Watt &amp; Fabricius</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#unnormalized" id="toc-unnormalized" class="nav-link" data-scroll-target="#unnormalized">Unnormalized</a></li>
  <li><a href="#prepping-for-normalization" id="toc-prepping-for-normalization" class="nav-link" data-scroll-target="#prepping-for-normalization">Prepping for normalization</a></li>
  <li><a href="#normalizations" id="toc-normalizations" class="nav-link" data-scroll-target="#normalizations">Normalizations</a>
  <ul class="collapse">
  <li><a href="#lobanov-a.k.a.-z-score" id="toc-lobanov-a.k.a.-z-score" class="nav-link" data-scroll-target="#lobanov-a.k.a.-z-score">Lobanov a.k.a. z-score</a></li>
  <li><a href="#nearey-a.k.a.-nearey-2" id="toc-nearey-a.k.a.-nearey-2" class="nav-link" data-scroll-target="#nearey-a.k.a.-nearey-2">Nearey (a.k.a. Nearey 2)</a></li>
  <li><a href="#watt-fabricius-1" id="toc-watt-fabricius-1" class="nav-link" data-scroll-target="#watt-fabricius-1">Watt &amp; Fabricius</a></li>
  </ul></li>
  <li><a href="#final-thoughts" id="toc-final-thoughts" class="nav-link" data-scroll-target="#final-thoughts">Final thoughts</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">How to normalize your vowels using the tidyverse</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">vowels</div>
    <div class="quarto-category">normalization</div>
    <div class="quarto-category">R</div>
  </div>
  </div>

<div>
  <div class="description">
    A tutorial on how to normalize vowel formant measurments in R using the tidyverse
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><a href="https://jofrhwld.github.io/">Josef Fruehwald</a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 20, 2022</p>
    </div>
  </div>
  
    
    <div>
    <div class="quarto-title-meta-heading">Doi</div>
    <div class="quarto-title-meta-contents">
      <p class="doi">
        <a href="https://doi.org/10.5281/zenodo.7232341">10.5281/zenodo.7232341</a>
      </p>
    </div>
  </div>
  </div>
  

</header>

<p>This is a tutorial about how to “normalize” vowel formant data using data tools from the <a href="https://www.tidyverse.org/">tidyverse</a>. A <em>lot</em> has been written about vowel normalization (why we do it, how it should work, what methods are best) that I can’t really cover here, although <span class="citation" data-cites="Adank2004">Adank &amp; Smits &amp; Hout (<a href="#ref-Adank2004" role="doc-biblioref">2004</a>)</span> is often taken as the canonical citation, and I’ll be taking into account the recent “order of operations” from <span class="citation" data-cites="stanley2022">Stanley (<a href="#ref-stanley2022" role="doc-biblioref">2022</a>)</span>.</p>
<p>There’s also a <code>vowels</code> R package <span class="citation" data-cites="vowels">(<a href="#ref-vowels" role="doc-biblioref">Kendall &amp; Thomas 2018</a>)</span> that basically lets you run <a href="http://lingtools.uoregon.edu/norm/norm1_methods.php">the NORM suite locally</a>.</p>
<p>There are still many occasions when you might want or need to normalize your vowel data yourself, though, and learning how to do it is actually a great introduction to a number of tidyverse “verbs”, especially:</p>
<ul>
<li><p><a href="https://dplyr.tidyverse.org/reference/group_by.html"><code>dplyr::group_by()</code></a></p></li>
<li><p><a href="https://dplyr.tidyverse.org/reference/summarise.html"><code>dplyr::summarise()</code></a></p></li>
<li><p><a href="https://dplyr.tidyverse.org/reference/mutate.html"><code>dplyr::mutate()</code></a></p></li>
<li><p><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html"><code>tidyr::pivot_longer()</code></a></p></li>
<li><p><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html"><code>tidyr::pivot_wider()</code></a></p></li>
</ul>
<p>Since I’m focusing on how data structures relate to vowel normalization, I’ll cover 3 specific normalization procedures:</p>
<section id="lobanov-a.k.a.-z-scoring" class="level3">
<h3 class="anchored" data-anchor-id="lobanov-a.k.a.-z-scoring">Lobanov (a.k.a. z-scoring)</h3>
<p>In terms of tidy data procedures, this is the simplest. All it requires is a <code>group_by()</code> and a <code>mutate()</code></p>
</section>
<section id="nearey-2" class="level3">
<h3 class="anchored" data-anchor-id="nearey-2">Nearey 2</h3>
<p>This procedure is a little more complicated, involving “pivoting” our data from wide to long, then long to wide again, using <code>pivot_longer()</code> and <code>pivot_wider()</code>.</p>
</section>
<section id="watt-fabricius" class="level3">
<h3 class="anchored" data-anchor-id="watt-fabricius">Watt &amp; Fabricius</h3>
<p>This method requires estimating by-speaker scaling factors (using <code>group_by()</code> and <code>summarise()</code>) then merging them back onto the original data (with <code>left_join()</code>).</p>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>To begin with, I’m going to import a few packages:</p>
<ul>
<li><p><code>tidyverse</code>: This is a “metapackage” that imports many different packages that contain functions we’ll need, including <code>ggplot2</code></p></li>
<li><p><code>ggforce</code>: This is a package that extends some of <code>ggplot2</code>’s functionality</p></li>
<li><p><code>khroma</code>: This is another packages that has many different color palates for <code>ggplot2</code>.</p></li>
<li><p><code>joeyr</code>: This is a package with functions written by Joey Stanley for vowel analysis.</p></li>
</ul>
<p>Any time I use a function that’s not loaded by the tidyverse, I’ll indicate it with the <code>package::function()</code> convention.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(khroma)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("JoeyStanley/joeyr")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(joeyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># set the ggplot2 theme</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We also need to load in some data. Here are two tab-delimited files of <a href="https://buckeyecorpus.osu.edu/">Buckeye Corpus</a> speakers whose interviews were run through <a href="https://github.com/JoFrhwld/FAVE">FAVE</a>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>s01_url <span class="ot">&lt;-</span> <span class="st">"?meta:website.site-url/content/R/tidy-norm/data/s01.txt"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>s03_url <span class="ot">&lt;-</span> <span class="st">"?meta:website.site-url/content/R/tidy-norm/data/s03.txt"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This code should load these files.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>vowels_orig <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">c</span>(s01_url, s03_url), </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">~</span><span class="fu">read_tsv</span>(.x, <span class="at">col_types=</span><span class="fu">cols</span>(<span class="at">sex =</span> <span class="st">'c'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details>
<summary>
What that <code>map_dfr</code> thing did:
</summary>
<p>The <code>map_dfr</code> function iterated over each url, and applied the function <code>read_tsv()</code> to them. I had to tell <code>read_tsv()</code> that the column <code>sex</code> should be treated as a character data type, since the value <code>f</code> gets reinterpreted as <code>FALSE</code> otherwise. After reading in each tab-delimited file, <code>map_dfr()</code> then combines the results together row-wise, to produce one large data frame.</p>
</details>
<p>The variable <code>vowels_orig</code> is now one large data frame with both speakers’ FAVE output in it. Here’s three randomly sampled rows from each speakers’ data.</p>
<div class="cell tbl-cap-location-bottom">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">50</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>vowels_orig <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-vowel-orig" class="anchored">

<div data-pagedtable="false"> <div class="table-caption">Table&nbsp;1:  <p>Three randomly sampled rows from each speaker’s data</p> </div>
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["age"],"name":[1],"type":["chr"],"align":["left"]},{"label":["city"],"name":[2],"type":["lgl"],"align":["right"]},{"label":["ethnicity"],"name":[3],"type":["lgl"],"align":["right"]},{"label":["first_name"],"name":[4],"type":["lgl"],"align":["right"]},{"label":["last_name"],"name":[5],"type":["lgl"],"align":["right"]},{"label":["location"],"name":[6],"type":["lgl"],"align":["right"]},{"label":["name"],"name":[7],"type":["chr"],"align":["left"]},{"label":["sex"],"name":[8],"type":["chr"],"align":["left"]},{"label":["state"],"name":[9],"type":["lgl"],"align":["right"]},{"label":["tiernum"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["year"],"name":[11],"type":["lgl"],"align":["right"]},{"label":["years_of_schooling"],"name":[12],"type":["lgl"],"align":["right"]},{"label":["vowel"],"name":[13],"type":["chr"],"align":["left"]},{"label":["stress"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["pre_word"],"name":[15],"type":["chr"],"align":["left"]},{"label":["word"],"name":[16],"type":["chr"],"align":["left"]},{"label":["fol_word"],"name":[17],"type":["chr"],"align":["left"]},{"label":["F1"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["F2"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["F3"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["B1"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["B2"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["B3"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["t"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["beg"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["end"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["dur"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["plt_vclass"],"name":[28],"type":["chr"],"align":["left"]},{"label":["ipa_vclass"],"name":[29],"type":["chr"],"align":["left"]},{"label":["plt_manner"],"name":[30],"type":["chr"],"align":["left"]},{"label":["plt_place"],"name":[31],"type":["chr"],"align":["left"]},{"label":["plt_voice"],"name":[32],"type":["chr"],"align":["left"]},{"label":["plt_preseg"],"name":[33],"type":["chr"],"align":["left"]},{"label":["plt_folseq"],"name":[34],"type":["chr"],"align":["left"]},{"label":["style"],"name":[35],"type":["lgl"],"align":["right"]},{"label":["glide"],"name":[36],"type":["chr"],"align":["left"]},{"label":["pre_seg"],"name":[37],"type":["chr"],"align":["left"]},{"label":["fol_seg"],"name":[38],"type":["chr"],"align":["left"]},{"label":["context"],"name":[39],"type":["chr"],"align":["left"]},{"label":["vowel_index"],"name":[40],"type":["dbl"],"align":["right"]},{"label":["pre_word_trans"],"name":[41],"type":["chr"],"align":["left"]},{"label":["word_trans"],"name":[42],"type":["chr"],"align":["left"]},{"label":["fol_word_trans"],"name":[43],"type":["chr"],"align":["left"]},{"label":["F1@20%"],"name":[44],"type":["dbl"],"align":["right"]},{"label":["F2@20%"],"name":[45],"type":["dbl"],"align":["right"]},{"label":["F1@35%"],"name":[46],"type":["dbl"],"align":["right"]},{"label":["F2@35%"],"name":[47],"type":["dbl"],"align":["right"]},{"label":["F1@50%"],"name":[48],"type":["dbl"],"align":["right"]},{"label":["F2@50%"],"name":[49],"type":["dbl"],"align":["right"]},{"label":["F1@65%"],"name":[50],"type":["dbl"],"align":["right"]},{"label":["F2@65%"],"name":[51],"type":["dbl"],"align":["right"]},{"label":["F1@80%"],"name":[52],"type":["dbl"],"align":["right"]},{"label":["F2@80%"],"name":[53],"type":["dbl"],"align":["right"]},{"label":["nFormants"],"name":[54],"type":["dbl"],"align":["right"]}],"data":[{"1":"y","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"s01","8":"f","9":"NA","10":"0","11":"NA","12":"NA","13":"IY","14":"0","15":"THESE","16":"REALLY","17":"ARE","18":"555.3","19":"2140.4","20":"3260.0","21":"237.0","22":"149.0","23":"310.5","24":"2677.844","25":"2677.811","26":"2677.911","27":"0.10","28":"iyF","29":"iF","30":"NA","31":"NA","32":"NA","33":"liquid","34":"NA","35":"NA","36":"NA","37":"L","38":"AA1","39":"final","40":"4","41":"DH IY1 Z","42":"R IH1 L IY0","43":"AA1 R","44":"605.8","45":"1935.0","46":"568.2","47":"2100.6","48":"528.1","49":"2216.9","50":"591.2","51":"2161.8","52":"645.2","53":"2073.1","54":"5"},{"1":"y","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"s01","8":"f","9":"NA","10":"0","11":"NA","12":"NA","13":"AH","14":"0","15":"WONDERFUL","16":"REPUTATION","17":"AN","18":"602.3","19":"2017.2","20":"3149.3","21":"145.5","22":"308.1","23":"126.9","24":"735.287","25":"735.264","26":"735.334","27":"0.07","28":"@","29":"ə","30":"nasal","31":"apical","32":"voiced","33":"palatal","34":"NA","35":"NA","36":"NA","37":"SH","38":"N","39":"internal","40":"9","41":"W AH1 N D ER0 F AH0 L","42":"R EH2 P Y AH0 T EY1 SH AH0 N","43":"AH0 N","44":"962.4","45":"2333.7","46":"661.2","47":"2092.4","48":"585.0","49":"1872.9","50":"573.0","51":"1934.5","52":"563.2","53":"1923.1","54":"5"},{"1":"y","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"s01","8":"f","9":"NA","10":"0","11":"NA","12":"NA","13":"EH","14":"1","15":"QUITE","16":"WELL","17":"NOW","18":"709.6","19":"1388.0","20":"2788.7","21":"171.5","22":"194.6","23":"183.9","24":"584.777","25":"584.757","26":"584.817","27":"0.06","28":"e","29":"ɛ","30":"lateral","31":"apical","32":"voiced","33":"w/y","34":"NA","35":"NA","36":"NA","37":"W","38":"L","39":"internal","40":"2","41":"K W AY1 T","42":"W EH1 L","43":"N AW1","44":"635.1","45":"1314.8","46":"635.1","47":"1314.8","48":"777.8","49":"1445.7","50":"803.7","51":"1455.2","52":"804.4","53":"1451.3","54":"5"},{"1":"o","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"s03","8":"m","9":"NA","10":"0","11":"NA","12":"NA","13":"ER","14":"1","15":"TODAY","16":"VERSUS","17":"WHAT","18":"409.7","19":"1251.9","20":"3475.6","21":"106.6","22":"119.1","23":"326.0","24":"1993.785","25":"1993.742","26":"1993.872","27":"0.13","28":"*hr","29":"ə˞","30":"fricative","31":"apical","32":"voiceless","33":"oral_labial","34":"one_fol_syll","35":"NA","36":"NA","37":"V","38":"S","39":"internal","40":"2","41":"T AH0 D EY1","42":"V ER1 S AH0 S","43":"W AH1 T","44":"607.3","45":"2460.1","46":"411.1","47":"1261.4","48":"408.2","49":"1225.1","50":"351.9","51":"1299.7","52":"1327.9","53":"3962.3","54":"3"},{"1":"o","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"s03","8":"m","9":"NA","10":"0","11":"NA","12":"NA","13":"AA","14":"2","15":"WELL","16":"GRANDPA","17":"HOW","18":"536.1","19":"857.6","20":"2272.3","21":"134.7","22":"111.2","23":"335.8","24":"3291.208","25":"3291.151","26":"3291.321","27":"0.17","28":"o","29":"ɑ","30":"NA","31":"NA","32":"NA","33":"oral_labial","34":"NA","35":"NA","36":"NA","37":"P","38":"HH","39":"final","40":"6","41":"W EH1 L","42":"G R AE1 M P AA2","43":"HH AW1","44":"444.9","45":"893.9","46":"533.6","47":"861.6","48":"554.7","49":"829.6","50":"508.0","51":"853.2","52":"620.7","53":"1022.6","54":"6"},{"1":"o","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"s03","8":"m","9":"NA","10":"0","11":"NA","12":"NA","13":"IH","14":"0","15":"OF","16":"THIS","17":"MASS","18":"429.4","19":"1460.3","20":"2851.0","21":"61.9","22":"244.1","23":"635.2","24":"936.169","25":"936.136","26":"936.236","27":"0.10","28":"i","29":"ɪ","30":"fricative","31":"apical","32":"voiceless","33":"oral_apical","34":"NA","35":"NA","36":"NA","37":"DH","38":"S","39":"internal","40":"2","41":"AH0 V","42":"DH IH0 S","43":"M AE1 S","44":"420.9","45":"1372.7","46":"428.0","47":"1441.2","48":"427.1","49":"1487.8","50":"415.2","51":"1517.5","52":"385.8","53":"1482.9","54":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<p>FAVE outputs a lot of useful information, but for this tutorial, I want to narrow down our focus to just a few columns</p>
<ul>
<li><p><code>name</code>: We’ll use this as a unique ID for each speaker</p></li>
<li><p><code>word</code>: It’s just good to keep this info around</p></li>
<li><p><code>ipa_vclass</code>: A column indicating each token’s vowel class in an IPA-like format</p></li>
<li><p><code>F1</code>, <code>F2</code>: What we’re all here for. The first and second formants.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>vowels_orig <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, word, ipa_vclass, F1, F2) <span class="ot">-&gt;</span> vowels_focus</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>vowels_focus <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-vowel-focus" class="anchored">

<div data-pagedtable="false"> <div class="table-caption">Table&nbsp;2:  <p>The first few rows of the data we’re going to work with</p> </div>
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["word"],"name":[2],"type":["chr"],"align":["left"]},{"label":["ipa_vclass"],"name":[3],"type":["chr"],"align":["left"]},{"label":["F1"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F2"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"s01","2":"OKAY","3":"ejF","4":"763.5","5":"2088.1"},{"1":"s01","2":"UM","3":"ʌ","4":"699.5","5":"1881.3"},{"1":"s01","2":"I'M","3":"aj","4":"888.8","5":"1934.1"},{"1":"s01","2":"LIVED","3":"ɪ","4":"555.5","5":"1530.5"},{"1":"s01","2":"IN","3":"ɪ","4":"612.2","5":"2323.4"},{"1":"s01","2":"COLUMBUS","3":"ə","4":"612.4","5":"1903.7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</section>
<section id="unnormalized" class="level2">
<h2 class="anchored" data-anchor-id="unnormalized">Unnormalized</h2>
<p>First, let’s see how things look when we get our vowel means and plot them unnormalized. I won’t go into detail about how the plotting code works (see the LingMethodsHub tutorial on <a href="https://lingmethodshub.github.io/content/R/vowel-plots-tutorial/">ggplot2 vowel plots</a>).</p>
<div class="cell">
<details>
<summary>Plot code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>vowels_focus <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1, F2), <span class="at">.fns =</span> mean)) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(F2, F1, <span class="at">color =</span> name))<span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ipa_vclass))<span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_hull</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_color_vibrant</span>()<span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_fill_vibrant</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using the `size` aesthetic in this geom was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` in the `default_aes` field and elsewhere instead.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-unnorm1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-unnorm1-1.png" class="quarto-discovered-preview-image img-fluid figure-img" alt="An F1 by F2 plot of two speakers' unnormalized vowel means." width="576"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Speakers’ vowel means in unnormalized F1,F2 space.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Here, we see reason number 1 why we’ll want to normalize vowels. These two speakers vowel spaced hardly overlap, but the <em>relative</em> position of vowel categories inside their spaces are fairly similar. All normalization methods try to do is pinch and scale <em>appropriately</em> to get the relative positions of these vowel spaces to overlap.</p>
<p><em>Another</em> reason we might be motivated to normalize our data is because F2 has a much larger range of data than F1. We can more easily see that if we add <code>coord_fixed()</code> to the plot.</p>
<div class="cell">
<details>
<summary>Plot code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>vowels_focus <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1, F2), <span class="at">.fns =</span> mean)) <span class="sc">|&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(F2, F1, <span class="at">color =</span> name))<span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ipa_vclass))<span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_hull</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_color_vibrant</span>()<span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_fill_vibrant</span>()<span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-unnorm2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-unnorm2-1.png" class="img-fluid figure-img" alt="An F1 by F2 plot of two speakers' unnormalized vowel means." width="576"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Speakers’ vowel means in unnormalized F1,F2 space. (fixed coords)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The plot is squished because F2 just has that much larger a range of values than F1. Any stats or calculations we do on vowels in the F1<span class="math inline">\(\times\)</span>F2 space is going to be dominated by things that happen across F2 vs F1.</p>
</section>
<section id="prepping-for-normalization" class="level2">
<h2 class="anchored" data-anchor-id="prepping-for-normalization">Prepping for normalization</h2>
<p>In order to get ready for normalization, I’m going to first filter out any vowel tokens that have a <span class="math inline">\(\sqrt{\text{mahalanobis}}\)</span> distance from its vowel class greater than 2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>vowels_focus <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mahal =</span> joeyr<span class="sc">::</span><span class="fu">tidy_mahalanobis</span>(F1, F2),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mahal_sq =</span> <span class="fu">sqrt</span>(mahal)) <span class="sc">|&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mahal_sq <span class="sc">&lt;=</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="ot">-&gt;</span> vowels_inlie</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="normalizations" class="level2">
<h2 class="anchored" data-anchor-id="normalizations">Normalizations</h2>
<section id="lobanov-a.k.a.-z-score" class="level3">
<h3 class="anchored" data-anchor-id="lobanov-a.k.a.-z-score">Lobanov a.k.a. z-score</h3>
<p>The first normalization procedure we’ll look at is “Lobanov” normalization <span class="citation" data-cites="lobanov">(<a href="#ref-lobanov" role="doc-biblioref">Lobanov 1971</a>)</span>. An important thing to know here is that while phoneticians may call this procedure “Lobanov” normalization, the rest of the data analysis world calls it “z-score” or even just “standard score.”</p>
<p>The process works like this:</p>
<ul>
<li><p>Within each speaker’s data ⤵️</p>
<ul>
<li><p>Within each formant ⤵️</p>
<ul>
<li>subtract the mean of the formant, and divide by the standard deviation of the formant</li>
</ul></li>
</ul></li>
</ul>
<p>Since we already a have F1 and F2 separated out into separate columns, this means all we have to do us <code>group_by()</code> our vowels data by speaker ID (in <code>name</code>), then create our new normalized columns by subtracting the mean and dividing by the standard deviation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">F1_z =</span> (F1 <span class="sc">-</span> <span class="fu">mean</span>(F1))<span class="sc">/</span><span class="fu">sd</span>(F1),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">F2_z =</span> (F2 <span class="sc">-</span> <span class="fu">mean</span>(F2))<span class="sc">/</span><span class="fu">sd</span>(F2)) <span class="ot">-&gt;</span> vowels_score1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>group_by(name)</code> process in this pipeline means that when we calculate <code>mean(F1)</code> and <code>std(F1)</code> in the next part, those mean and standard deviation values are for each speaker’s subset of <code>vowels_inlie</code>.</p>
<p>Since z-scoring is so common a thing to do in quantitative analysis, R actually has a built in function, <code>scale()</code> that we could use instead of writing the math out ourselves.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">F1_z =</span> <span class="fu">scale</span>(F1),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">F2_z =</span> <span class="fu">scale</span>(F2)) <span class="ot">-&gt;</span> vowels_zscore2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="results" class="level4">
<h4 class="anchored" data-anchor-id="results">Results</h4>
<p>Here’s the results of z-scoring! We’ve got largely overlapping vowel spaces now. The numeric values of these z-scores tend to run somewhere between -3 and 3 (less extreme for means). Both formants are also on the same scale, which you can see with the plot being roughly square shaped even with <code>coord_fixed()</code> being added.</p>
<div class="cell">
<details>
<summary>Plot code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>vowels_zscore2 <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1_z, F2_z), <span class="at">.fns =</span> mean)) <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(F2_z, F1_z, <span class="at">color =</span> name))<span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ipa_vclass))<span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_hull</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_color_vibrant</span>()<span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_fill_vibrant</span>()<span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-zscore" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-zscore-1.png" class="img-fluid figure-img" alt="An F1 by F2 plot of two speakers' Lobanov normalized vowel means." width="576"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Speakers’ vowel means in z-scored F1,F2 space. (fixed coords)</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="nearey-a.k.a.-nearey-2" class="level3">
<h3 class="anchored" data-anchor-id="nearey-a.k.a.-nearey-2">Nearey (a.k.a. Nearey 2)</h3>
<p>Next, we’ll look at what the vowels package calls “Nearey 2” normalization <span class="citation" data-cites="nearey1978">(<a href="#ref-nearey1978" role="doc-biblioref">Nearey 1978</a>)</span>. The Nearey 1 procedure is more similar in terms of data code as z-scoring.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> The Nearey 2 procedure works like this:</p>
<ul>
<li><p>Within each speaker ⤵️</p>
<ul>
<li><p>Convert <em>all</em> formant measurements to log-Hz</p></li>
<li><p>Get the mean log-Hz across all measurements (F1 and F2 <em>together</em>)</p></li>
<li><p>Subtract the mean log-Hz from the log-Hz</p></li>
<li><p>“Anti-log” or exponentiate the result</p></li>
</ul></li>
</ul>
<p>We need to combine F1 and F2 measurements together to get their mean, and this is best achieved in the tidyverse by “pivoting” the data frame from wide to long. We’ll take it in steps. In each next step, I’m going to be putting additional tidyverse verbs between the data frame and the line that has <code>head() |&gt; rmarkdown::paged_table()</code>, which is just there to provide nice looking output.</p>
<section id="step-1-focus-in-on-the-columns-of-interest" class="level4">
<h4 class="anchored" data-anchor-id="step-1-focus-in-on-the-columns-of-interest">Step 1: Focus in on the columns of interest</h4>
<p>The <code>vowels_inlie</code> has data columns for the mahalanobis distance, which I want to drop off for now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, word, ipa_vclass, F1, F2) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># more verbs to go here</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-nearey-focus" class="anchored">

<div data-pagedtable="false"> <div class="table-caption">Table&nbsp;3:  <p>The columns of importance for Neary 2</p> </div>
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["word"],"name":[2],"type":["chr"],"align":["left"]},{"label":["ipa_vclass"],"name":[3],"type":["chr"],"align":["left"]},{"label":["F1"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F2"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"s01","2":"UM","3":"ʌ","4":"699.5","5":"1881.3"},{"1":"s01","2":"I'M","3":"aj","4":"888.8","5":"1934.1"},{"1":"s01","2":"IN","3":"ɪ","4":"612.2","5":"2323.4"},{"1":"s01","2":"COLUMBUS","3":"ə","4":"612.4","5":"1903.7"},{"1":"s01","2":"ENTIRE","3":"ɪ","4":"529.9","5":"2332.1"},{"1":"s01","2":"ENTIRE","3":"ə˞","4":"538.4","5":"1682.8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</section>
<section id="step-2-add-an-id-column" class="level4">
<h4 class="anchored" data-anchor-id="step-2-add-an-id-column">Step 2: Add an ID column</h4>
<p>When we’re pivoting our data long and then wide again, we need to have a column that is a unique id for each vowel observation. I’ll create that with <code>mutate(id = 1:n())</code> . The <code>n()</code> function there is a convenience function that returns the number of rows in each (group) of the data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, word, ipa_vclass, F1, F2) <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># more verbs to go here</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-nearey-id" class="anchored">

<div data-pagedtable="false"> <div class="table-caption">Table&nbsp;4:  <p>The formant data with a token ID for each observation</p> </div>
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["word"],"name":[2],"type":["chr"],"align":["left"]},{"label":["ipa_vclass"],"name":[3],"type":["chr"],"align":["left"]},{"label":["F1"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F2"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["id"],"name":[6],"type":["int"],"align":["right"]}],"data":[{"1":"s01","2":"UM","3":"ʌ","4":"699.5","5":"1881.3","6":"1"},{"1":"s01","2":"I'M","3":"aj","4":"888.8","5":"1934.1","6":"2"},{"1":"s01","2":"IN","3":"ɪ","4":"612.2","5":"2323.4","6":"3"},{"1":"s01","2":"COLUMBUS","3":"ə","4":"612.4","5":"1903.7","6":"4"},{"1":"s01","2":"ENTIRE","3":"ɪ","4":"529.9","5":"2332.1","6":"5"},{"1":"s01","2":"ENTIRE","3":"ə˞","4":"538.4","5":"1682.8","6":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</section>
<section id="step-3-pivot-longer" class="level4">
<h4 class="anchored" data-anchor-id="step-3-pivot-longer">Step 3: Pivot Longer</h4>
<p>Now, we want to take the F1 and F2 columns, and stack them one on top of each other, which we can do with <code>pivot_longer()</code>. This function needs to know at least three things:</p>
<ul>
<li><p>Which columns are we going to be stacking on top of each other?</p>
<ul>
<li>We pass this information to the <code>cols=</code> argument.</li>
</ul></li>
<li><p>How should we keep track of the original column names?</p>
<ul>
<li>We pass this information to <code>names_to=</code>.</li>
</ul></li>
<li><p>How should we keep track of the original values from these columns?</p>
<ul>
<li>We pass this information to <code>values_to=</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, word, ipa_vclass, F1, F2) <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> F1<span class="sc">:</span>F2, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"formant"</span>, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"hz"</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># more verbs to go here</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">12</span>) <span class="sc">|&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-nearey-long" class="anchored">

<div data-pagedtable="false"> <div class="table-caption">Table&nbsp;5:  <p>The formant data, pivoted long</p> </div>
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["word"],"name":[2],"type":["chr"],"align":["left"]},{"label":["ipa_vclass"],"name":[3],"type":["chr"],"align":["left"]},{"label":["id"],"name":[4],"type":["int"],"align":["right"]},{"label":["formant"],"name":[5],"type":["chr"],"align":["left"]},{"label":["hz"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"s01","2":"UM","3":"ʌ","4":"1","5":"F1","6":"699.5"},{"1":"s01","2":"UM","3":"ʌ","4":"1","5":"F2","6":"1881.3"},{"1":"s01","2":"I'M","3":"aj","4":"2","5":"F1","6":"888.8"},{"1":"s01","2":"I'M","3":"aj","4":"2","5":"F2","6":"1934.1"},{"1":"s01","2":"IN","3":"ɪ","4":"3","5":"F1","6":"612.2"},{"1":"s01","2":"IN","3":"ɪ","4":"3","5":"F2","6":"2323.4"},{"1":"s01","2":"COLUMBUS","3":"ə","4":"4","5":"F1","6":"612.4"},{"1":"s01","2":"COLUMBUS","3":"ə","4":"4","5":"F2","6":"1903.7"},{"1":"s01","2":"ENTIRE","3":"ɪ","4":"5","5":"F1","6":"529.9"},{"1":"s01","2":"ENTIRE","3":"ɪ","4":"5","5":"F2","6":"2332.1"},{"1":"s01","2":"ENTIRE","3":"ə˞","4":"6","5":"F1","6":"538.4"},{"1":"s01","2":"ENTIRE","3":"ə˞","4":"6","5":"F2","6":"1682.8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<p>You can get an idea for what <code>pivot_longer()</code> has done by comparing this table (<a href="#tbl-nearey-long">Table&nbsp;5</a>) to the table before (<a href="#tbl-nearey-id">Table&nbsp;4</a>). There are two rows in this long table for every row in the wide table. The <code>name</code>, <code>word</code>, <code>ipa_vclass</code>, and <code>id</code> values are repeated twice. There’s also a new <code>formant</code> column, which contains the column names we pivoted longer, and a new <code>hz</code> column, which contains the values from the columns we pivoted longer.</p>
</section>
<section id="step-4-the-actual-normalization" class="level4">
<h4 class="anchored" data-anchor-id="step-4-the-actual-normalization">Step 4: The actual normalization!</h4>
<p>Now we can do the actual normalization. The column we’ll target is the new <code>hz</code> column. We’ll log it, subtract the mean log value, then convert it back to its original scale with <code>exp()</code>. And don’t forget we need to <code>group_by(name)</code> first too!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, word, ipa_vclass, F1, F2) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> F1<span class="sc">:</span>F2, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"formant"</span>, </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"hz"</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nearey =</span> <span class="fu">exp</span>(<span class="fu">log</span>(hz)<span class="sc">-</span><span class="fu">mean</span>(<span class="fu">log</span>(hz))))<span class="sc">|&gt;</span>  </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># more verbs to go here</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">12</span>) <span class="sc">|&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-nearey-norm" class="anchored">

<div data-pagedtable="false"> <div class="table-caption">Table&nbsp;6:  <p>The formant data, pivoted long, and normalized</p> </div>
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["word"],"name":[2],"type":["chr"],"align":["left"]},{"label":["ipa_vclass"],"name":[3],"type":["chr"],"align":["left"]},{"label":["id"],"name":[4],"type":["int"],"align":["right"]},{"label":["formant"],"name":[5],"type":["chr"],"align":["left"]},{"label":["hz"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["nearey"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"s01","2":"UM","3":"ʌ","4":"1","5":"F1","6":"699.5","7":"0.6325928"},{"1":"s01","2":"UM","3":"ʌ","4":"1","5":"F2","6":"1881.3","7":"1.7013537"},{"1":"s01","2":"I'M","3":"aj","4":"2","5":"F1","6":"888.8","7":"0.8037863"},{"1":"s01","2":"I'M","3":"aj","4":"2","5":"F2","6":"1934.1","7":"1.7491034"},{"1":"s01","2":"IN","3":"ɪ","4":"3","5":"F1","6":"612.2","7":"0.5536431"},{"1":"s01","2":"IN","3":"ɪ","4":"3","5":"F2","6":"2323.4","7":"2.1011669"},{"1":"s01","2":"COLUMBUS","3":"ə","4":"4","5":"F1","6":"612.4","7":"0.5538240"},{"1":"s01","2":"COLUMBUS","3":"ə","4":"4","5":"F2","6":"1903.7","7":"1.7216112"},{"1":"s01","2":"ENTIRE","3":"ɪ","4":"5","5":"F1","6":"529.9","7":"0.4792151"},{"1":"s01","2":"ENTIRE","3":"ɪ","4":"5","5":"F2","6":"2332.1","7":"2.1090347"},{"1":"s01","2":"ENTIRE","3":"ə˞","4":"6","5":"F1","6":"538.4","7":"0.4869021"},{"1":"s01","2":"ENTIRE","3":"ə˞","4":"6","5":"F2","6":"1682.8","7":"1.5218402"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</section>
<section id="step-5-pivoting-wide-again-for-plotting" class="level4">
<h4 class="anchored" data-anchor-id="step-5-pivoting-wide-again-for-plotting">Step 5: Pivoting wide again, for plotting</h4>
<p>Technically, we’re done normalizing the formant data, but in order to make a nice F1<span class="math inline">\(\times\)</span>F2 plot, we need to pivot the data wide again.</p>
<p>To do that, we first need to drop the <code>hz</code> column, because <code>pivot_wider()</code> will go weird if we don’t.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> Then, we need to tell <code>pivot_wider()</code> the following information:</p>
<ul>
<li><p>Where should it get the names of new columns from?</p>
<ul>
<li>We’ll pass this to <code>names_from=</code></li>
</ul></li>
<li><p>Where should it get the values to put into the new columns from?</p>
<ul>
<li>We’ll pass this to <code>values_from=</code></li>
</ul></li>
</ul>
<p>After this step, we’re done the normalizing process, so I’ll assign the result to a variable called <code>vowels_neary</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, word, ipa_vclass, F1, F2) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> F1<span class="sc">:</span>F2, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"formant"</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"hz"</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nearey =</span> <span class="fu">exp</span>(<span class="fu">log</span>(hz)<span class="sc">-</span><span class="fu">mean</span>(<span class="fu">log</span>(hz))))<span class="sc">|&gt;</span>  </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>hz) <span class="sc">|&gt;</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> formant, <span class="at">values_from =</span> nearey) <span class="ot">-&gt;</span> vowels_nearey</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>vowels_nearey <span class="sc">|&gt;</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-neary-wide" class="anchored">

<div data-pagedtable="false"> <div class="table-caption">Table&nbsp;7:  <p>Nearey Normalized Vowels, wide again</p> </div>
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["word"],"name":[2],"type":["chr"],"align":["left"]},{"label":["ipa_vclass"],"name":[3],"type":["chr"],"align":["left"]},{"label":["id"],"name":[4],"type":["int"],"align":["right"]},{"label":["F1"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["F2"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"s01","2":"UM","3":"ʌ","4":"1","5":"0.6325928","6":"1.701354"},{"1":"s01","2":"I'M","3":"aj","4":"2","5":"0.8037863","6":"1.749103"},{"1":"s01","2":"IN","3":"ɪ","4":"3","5":"0.5536431","6":"2.101167"},{"1":"s01","2":"COLUMBUS","3":"ə","4":"4","5":"0.5538240","6":"1.721611"},{"1":"s01","2":"ENTIRE","3":"ɪ","4":"5","5":"0.4792151","6":"2.109035"},{"1":"s01","2":"ENTIRE","3":"ə˞","4":"6","5":"0.4869021","6":"1.521840"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</section>
<section id="results-1" class="level4">
<h4 class="anchored" data-anchor-id="results-1">Results!</h4>
<div class="cell">
<details>
<summary>Plot code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>vowels_nearey <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1, F2), <span class="at">.fns =</span> mean)) <span class="sc">|&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(F2, F1, <span class="at">color =</span> name))<span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ipa_vclass))<span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_hull</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_color_vibrant</span>()<span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_fill_vibrant</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-neary-norm" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-neary-norm-1.png" class="img-fluid figure-img" width="624"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: An F1 by F2 plot of two speakers’ Nearey normalized vowel means.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Again, the vowel spaces are largely overlapping. One thing that’s not immediately clear from this graph, though, is that this specific approach to Nearey normalization still has a much wider range for F2 than F1, which we can see if we plot it with fixed coordinates.</p>
<div class="cell">
<details>
<summary>Plot code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>vowels_nearey <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1, F2), <span class="at">.fns =</span> mean)) <span class="sc">|&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(F2, F1, <span class="at">color =</span> name))<span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ipa_vclass))<span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_hull</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_color_vibrant</span>()<span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_fill_vibrant</span>()<span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-neary-norm-fixed" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-neary-norm-fixed-1.png" class="img-fluid figure-img" width="624"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5: An F1 by F2 plot of two speakers’ Nearey normalized vowel means. (fixed coordinates).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>It gets better if we plot the log of the normalized values<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, but then the vowel space doesn’t look like the familiar hertz space.</p>
<div class="cell">
<details>
<summary>Plot code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>vowels_nearey <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1, F2), <span class="at">.fns =</span> <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">log</span>(.x)))) <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(F2, F1, <span class="at">color =</span> name))<span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ipa_vclass))<span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_hull</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_color_vibrant</span>()<span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_fill_vibrant</span>()<span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-neary-log-norm-fixed" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-neary-log-norm-fixed-1.png" class="img-fluid figure-img" width="624"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6: Speakers’ vowel means in Log Nearey Normalized F1,F2 space (fixed coordinates).</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="watt-fabricius-1" class="level3">
<h3 class="anchored" data-anchor-id="watt-fabricius-1">Watt &amp; Fabricius</h3>
<p>The final normalization method we’ll look at, which can’t easily be done with a single sequence of tidyverse verbs, is the Watt &amp; Fabricius method <span class="citation" data-cites="watt2002">(<a href="#ref-watt2002" role="doc-biblioref">Watt &amp; Fabricius 2002</a>)</span>. The idea behind the Watt &amp; Fabricius method is to define a vowel space triangle for each speaker, then to scale their formant values to the triangle.</p>
<section id="step-1-getting-the-triangle-points" class="level4">
<h4 class="anchored" data-anchor-id="step-1-getting-the-triangle-points">Step 1: Getting the Triangle Points</h4>
<p>I’ll follow the NORM suite and define the points of the triangle like so:</p>
<ul>
<li><p>Top Left Corner, “beet” point: The F1 of the vowel with the smallest F1, and the F2 of the vowel with the largest F2</p></li>
<li><p>Bottom Corner, “bat” point: The F1 of the vowel with the maximum F1, and the F2 of that same vowel.</p></li>
<li><p>Top Right Corner, “school” point: F1 = F2 = “beet” point F1.</p></li>
</ul>
<p>Here’s how you can get those values per speaker:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1, F2), mean)) <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">beet_f1 =</span> <span class="fu">min</span>(F1),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">beet_f2 =</span> <span class="fu">max</span>(F2),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">bat_f1 =</span> <span class="fu">max</span>(F1),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">bat_f2 =</span> F2[F1 <span class="sc">==</span> <span class="fu">max</span>(F1)]) <span class="sc">|&gt;</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">school_f1 =</span> beet_f1,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">school_f2 =</span> beet_f1) <span class="sc">|&gt;</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># more verbs to go here</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-wf-points" class="anchored">

<div data-pagedtable="false"> <div class="table-caption">Table&nbsp;8:  <p>The vowel triangle point values.</p> </div>
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["beet_f1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["beet_f2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["bat_f1"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["bat_f2"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["school_f1"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["school_f2"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"s01","2":"430.4145","3":"2595.765","4":"819.6912","5":"1901.572","6":"430.4145","7":"430.4145"},{"1":"s03","2":"316.1036","3":"1989.806","4":"674.2896","5":"1242.969","6":"316.1036","7":"316.1036"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<p>In order to plot these points in an F1<span class="math inline">\(\times\)</span>F2 space, we need to do a little <code>pivot_longer()</code> and <code>pivot_wider()</code> again with the following steps:</p>
<ul>
<li><p><code>pivot_longer()</code>, to stack the values of the columns between <code>beet_f1</code> and <code>school_f2</code> on top of each other.</p></li>
<li><p>Split the point names (e.g.&nbsp;“<code>beet_f1"</code>) into separate values (e.g.&nbsp;<code>"beet"</code> and <code>"beet"</code>) using <code>separate()</code>.</p></li>
<li><p><code>pivot_wider()</code> using the column with <code>"f1"</code> and <code>"f2"</code> to make the new column names.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1, F2), mean)) <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">beet_f1 =</span> <span class="fu">min</span>(F1),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">beet_f2 =</span> <span class="fu">max</span>(F2),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">bat_f1 =</span> <span class="fu">max</span>(F1),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">bat_f2 =</span> F2[F1 <span class="sc">==</span> <span class="fu">max</span>(F1)]) <span class="sc">|&gt;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">school_f1 =</span> beet_f1,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">school_f2 =</span> beet_f1) <span class="sc">|&gt;</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> beet_f1<span class="sc">:</span>school_f2, <span class="at">names_to =</span> <span class="st">"var"</span>, <span class="at">values_to =</span> <span class="st">"hz"</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(var, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"point"</span>, <span class="st">"formant"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> formant, <span class="at">values_from =</span> hz) <span class="ot">-&gt;</span> wf_points</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>wf_points <span class="sc">|&gt;</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-wf-point-long" class="anchored">

<div data-pagedtable="false"> <div class="table-caption">Table&nbsp;9:  <p>The vowel triangle point values, long version</p> </div>
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["point"],"name":[2],"type":["chr"],"align":["left"]},{"label":["f1"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["f2"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"s01","2":"beet","3":"430.4145","4":"2595.7652"},{"1":"s01","2":"bat","3":"819.6912","4":"1901.5715"},{"1":"s01","2":"school","3":"430.4145","4":"430.4145"},{"1":"s03","2":"beet","3":"316.1036","4":"1989.8057"},{"1":"s03","2":"bat","3":"674.2896","4":"1242.9689"},{"1":"s03","2":"school","3":"316.1036","4":"316.1036"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<p>When we plot thee triangle points, we wind up with a plot that looks like a very simplified version of the vowel space from <a href="#fig-unnorm1">Figure&nbsp;1</a>.</p>
<div class="cell">
<details>
<summary>Plot code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>wf_points <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(f2, f1))<span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name, <span class="at">color =</span> name), <span class="at">alpha =</span> <span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> point))<span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_vibrant</span>()<span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_vibrant</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-wf-triangle" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-wf-triangle-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;7: The vowel space triangles for the Watt &amp; Fabricius method</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-2-calculate-scaling-factors" class="level4">
<h4 class="anchored" data-anchor-id="step-2-calculate-scaling-factors">Step 2: Calculate Scaling Factors</h4>
<p>With the F1 and F2 of these triangle points, we then calculate scaling factors by just taking the mean of F1 and F2 for each speaker.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>wf_points <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">S1 =</span> <span class="fu">mean</span>(f1),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">S2 =</span> <span class="fu">mean</span>(f2)) <span class="ot">-&gt;</span> wf_scalers</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>wf_scalers <span class="sc">|&gt;</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-wf-scaler" class="anchored">

<div data-pagedtable="false"> <div class="table-caption">Table&nbsp;10:  <p>The Watt &amp; Fabricius scaling factors</p> </div>
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["S1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["S2"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"s01","2":"560.1734","3":"1642.584"},{"1":"s03","2":"435.4989","3":"1182.959"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</section>
<section id="step-3-merging-the-scalers-onto-the-original-data." class="level4">
<h4 class="anchored" data-anchor-id="step-3-merging-the-scalers-onto-the-original-data.">Step 3: Merging the scalers onto the original data.</h4>
<p>Now what we need to do is divide each speaker’s F1 and F2 value by these scalers. Right now the speakers’ original data is in <code>vowels_inlie</code> and the scaling values are in <code>wf_scalers</code>, so to do that division, we need to associate these two data frames.</p>
<p>Fortunately, both <code>vowels_inlie</code> and <code>wf_scalers</code> have a column name in common: the speaker ID column <code>name</code>. That means we can merge <code>wf_scalers</code> onto <code>vowels_inlie</code> with a join operation. There are a few different <code>*_join()</code> functions in the tidyverse, and here I’ll use <code>left_join()</code>.</p>
<p>We need to tell <code>left_join()</code> the following information:</p>
<ul>
<li><p>Which two data frames are we joining together?</p>
<ul>
<li>Since we’re piping, the first data frame will appear on the left hand side of <code>|&gt;</code>, and the second data frame will be the first argument.</li>
</ul></li>
<li><p>Which columns should we use to join the data frames together?</p>
<ul>
<li><code>left_join()</code> will guess and try to join the data together using columns with the same name, but we can explicitly tell it which columns to use with the <code>by=</code> argument.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(wf_scalers, <span class="at">by =</span> <span class="st">"name"</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># more verbs to go here</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The group_by here is just to illustrate that each speaker's scalers were</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># successfully merged</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span> <span class="fu">slice</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-wf-join" class="anchored">

<div data-pagedtable="false"> <div class="table-caption">Table&nbsp;11:  <p>Speakers’s scalers merged onto the original data</p> </div>
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["word"],"name":[2],"type":["chr"],"align":["left"]},{"label":["ipa_vclass"],"name":[3],"type":["chr"],"align":["left"]},{"label":["F1"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F2"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["mahal"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mahal_sq"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["S1"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["S2"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"s01","2":"UM","3":"ʌ","4":"699.5","5":"1881.3","6":"1.1248704","7":"1.0605991","8":"560.1734","9":"1642.584"},{"1":"s01","2":"I'M","3":"aj","4":"888.8","5":"1934.1","6":"0.4752467","7":"0.6893814","8":"560.1734","9":"1642.584"},{"1":"s01","2":"IN","3":"ɪ","4":"612.2","5":"2323.4","6":"1.5749328","7":"1.2549633","8":"560.1734","9":"1642.584"},{"1":"s03","2":"I","3":"aj","4":"771.5","5":"1257.4","6":"3.2346829","7":"1.7985224","8":"435.4989","9":"1182.959"},{"1":"s03","2":"HAVE","3":"æ","4":"639.5","5":"1609.3","6":"0.3964394","7":"0.6296344","8":"435.4989","9":"1182.959"},{"1":"s03","2":"A","3":"ə","4":"501.2","5":"1202.0","6":"2.0544758","7":"1.4333443","8":"435.4989","9":"1182.959"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</section>
<section id="step-4-the-actual-normalization-1" class="level4">
<h4 class="anchored" data-anchor-id="step-4-the-actual-normalization-1">Step 4: The actual normalization!</h4>
<p>Now all we need to do is divide F1 and F2 by their respective scaling factors to get the normalized Watt &amp; Fabricius values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(wf_scalers, <span class="at">by =</span> <span class="st">"name"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">F1_wf =</span> F1<span class="sc">/</span>S1,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">F2_wf =</span> F2<span class="sc">/</span>S2)<span class="ot">-&gt;</span>vowels_wf</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>vowels_wf <span class="sc">|&gt;</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-wf-norm" class="anchored">

<div data-pagedtable="false"> <div class="table-caption">Table&nbsp;12:  <p>Speakers’ vowels Watt &amp; Fabricius normalized</p> </div>
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["word"],"name":[2],"type":["chr"],"align":["left"]},{"label":["ipa_vclass"],"name":[3],"type":["chr"],"align":["left"]},{"label":["F1"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F2"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["mahal"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mahal_sq"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["S1"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["S2"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["F1_wf"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["F2_wf"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"s01","2":"UM","3":"ʌ","4":"699.5","5":"1881.3","6":"1.1248704","7":"1.0605991","8":"560.1734","9":"1642.584","10":"1.248720","11":"1.145330"},{"1":"s01","2":"I'M","3":"aj","4":"888.8","5":"1934.1","6":"0.4752467","7":"0.6893814","8":"560.1734","9":"1642.584","10":"1.586651","11":"1.177474"},{"1":"s01","2":"IN","3":"ɪ","4":"612.2","5":"2323.4","6":"1.5749328","7":"1.2549633","8":"560.1734","9":"1642.584","10":"1.092876","11":"1.414479"},{"1":"s03","2":"I","3":"aj","4":"771.5","5":"1257.4","6":"3.2346829","7":"1.7985224","8":"435.4989","9":"1182.959","10":"1.771531","11":"1.062927"},{"1":"s03","2":"HAVE","3":"æ","4":"639.5","5":"1609.3","6":"0.3964394","7":"0.6296344","8":"435.4989","9":"1182.959","10":"1.468431","11":"1.360402"},{"1":"s03","2":"A","3":"ə","4":"501.2","5":"1202.0","6":"2.0544758","7":"1.4333443","8":"435.4989","9":"1182.959","10":"1.150864","11":"1.016096"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</section>
<section id="results-2" class="level4">
<h4 class="anchored" data-anchor-id="results-2">Results!</h4>
<div class="cell">
<details>
<summary>Plot code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>vowels_wf <span class="sc">|&gt;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1_wf, F2_wf), <span class="at">.fns =</span> mean)) <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(F2_wf, F1_wf, <span class="at">color =</span> name))<span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ipa_vclass))<span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_hull</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_vibrant</span>()<span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_vibrant</span>()<span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-wf-norm" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-wf-norm-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;8: An F1 by F2 plot of two speakers’ Watt &amp; Fabricius normalized vowel means.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Again, we’ve got largely overlapping vowel spaces, and since F1 and F2 were normalized separately, they’ve got very comparable data ranges.</p>
</section>
</section>
</section>
<section id="final-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="final-thoughts">Final thoughts</h2>
<p>There there has been a <em>lot</em> written about vowel normalization methods, and I’ve barely covered most of the relevant topics discussed in the literature. For example:</p>
<ul>
<li><p>How well do these methods correspond to what <em>listeners</em> actually do when hearing people with different vowel spaces?</p></li>
<li><p>Should we really be plotting and analyzing formants in Hz, or should the by converted to a psychoacoustic dimension, like Mel or Bark?</p></li>
<li><p>Which method is the “Best”? What do we want a method to be “Best” <em>at</em>?</p></li>
</ul>
<p>Instead, I’ve covered some of most commonly used normalization methods, and also tried to provide an outline of how these methods correspond to specific data frame operations in the tidyverse.</p>


<!-- -->


</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list">
<div id="ref-Adank2004" class="csl-entry" role="listitem">
Adank, Patti &amp; Smits, Roel &amp; Hout, Roeland van. 2004. A comparison of vowel normalization procedures for language variation research. <em>The Journal of the Acoustical Society of America</em>. 116(5). 3099. Retrieved from <a href="http://link.aip.org/link/JASMAN/v116/i5/p3099/s1&amp;Agg=doi">http://link.aip.org/link/JASMAN/v116/i5/p3099/s1&amp;Agg=doi</a>
</div>
<div id="ref-vowels" class="csl-entry" role="listitem">
Kendall, Tyler &amp; Thomas, Erik R. 2018. Vowels: Vowel manipulation, normalization, and plotting. Retrieved from <a href="https://CRAN.R-project.org/package=vowels">https://CRAN.R-project.org/package=vowels</a>
</div>
<div id="ref-lobanov" class="csl-entry" role="listitem">
Lobanov, Boris. 1971. Classification of russian vowels spoken by different listeners. <em>Journal of the Acoustical Society of America</em>. 49. 606–608.
</div>
<div id="ref-nearey1978" class="csl-entry" role="listitem">
Nearey, Terrance. 1978. <em>Phonetic feature systems for vowels.</em> Retrieved from <a href="https://sites.ualberta.ca/~tnearey/Nearey1978_compressed.pdf">https://sites.ualberta.ca/~tnearey/Nearey1978_compressed.pdf</a>
</div>
<div id="ref-stanley2022" class="csl-entry" role="listitem">
Stanley, Joseph A. 2022. Order of Operations in Sociophonetic Analysis. <em>Penn Working Papers in Linguistics</em>. 28(2). 151–160. Retrieved from <a href="https://repository.upenn.edu/pwpl/vol28/iss2/17">https://repository.upenn.edu/pwpl/vol28/iss2/17</a>
</div>
<div id="ref-watt2002" class="csl-entry" role="listitem">
Watt, Dominic &amp; Fabricius, Anne. 2002. Evaluation of a technique for improving the mapping of multiple speakers’ vowel spaces in the F1 &nbsp; F2 plane. <em>Leeds Working Papers in Linguistics and Phonetics</em>. 9. 159–173.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">F1_n =</span> <span class="fu">exp</span>(<span class="fu">log</span>(F1) <span class="sc">-</span> <span class="fu">mean</span>(<span class="fu">log</span>(F1))),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">F2_n =</span> <span class="fu">exp</span>(<span class="fu">log</span>(F2) <span class="sc">-</span> <span class="fu">mean</span>(<span class="fu">log</span>(F2))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></li>
<li id="fn2"><p>But you should try it just to see!<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Which is a little silly because that’s what we had in the normalization code chunk above, and then we did <code>exp()</code> on it.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{fruehwald2022,
  author = {Fruehwald, Josef},
  title = {How to Normalize Your Vowels Using the Tidyverse},
  series = {Linguistics Methods Hub},
  date = {2022-10-20},
  url = {https://lingmethodshub.github.io/content/R/tidy-norm},
  doi = {10.5281/zenodo.7232341},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-fruehwald2022" class="csl-entry quarto-appendix-citeas" role="listitem">
Fruehwald, Josef. 2022, October 20. How to normalize your vowels using
the tidyverse. <em>Linguistics Methods Hub</em>. (<a href="https://lingmethodshub.github.io/content/R/tidy-norm">https://lingmethodshub.github.io/content/R/tidy-norm</a>).
doi: <a href="https://doi.org/10.5281/zenodo.7232341">10.5281/zenodo.7232341</a>
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../../content/R/vowel-plots-tutorial/index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Vowel Plots with <code>ggplot2</code></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../../content/R/animated_vowel_plots_tutorial/index.html" class="pagination-link">
        <span class="nav-page-text">Visualising Vowel Space Change with GAMMs</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb30" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "How to normalize your vowels using the tidyverse"</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="an">knitr:</span><span class="co"> </span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">  opts_chunk: </span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">    message: false</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "A tutorial on how to normalize vowel formant measurments in R using the tidyverse"</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">  - "vowels"</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co">  - "normalization"</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - "R"</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co">#source(".Rprofile")</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>This is a tutorial about how to "normalize" vowel formant data using data tools from the <span class="co">[</span><span class="ot">tidyverse</span><span class="co">](https://www.tidyverse.org/)</span>. A *lot* has been written about vowel normalization (why we do it, how it should work, what methods are best) that I can't really cover here, although @Adank2004 is often taken as the canonical citation, and I'll be taking into account the recent "order of operations" from @stanley2022.</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>There's also a <span class="in">`vowels`</span> R package <span class="co">[</span><span class="ot">@vowels</span><span class="co">]</span> that basically lets you run <span class="co">[</span><span class="ot">the NORM suite locally</span><span class="co">](http://lingtools.uoregon.edu/norm/norm1_methods.php)</span>.</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>There are still many occasions when you might want or need to normalize your vowel data yourself, though, and learning how to do it is actually a great introduction to a number of tidyverse "verbs", especially:</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`dplyr::group_by()`</span><span class="co">](https://dplyr.tidyverse.org/reference/group_by.html)</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`dplyr::summarise()`</span><span class="co">](https://dplyr.tidyverse.org/reference/summarise.html)</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`dplyr::mutate()`</span><span class="co">](https://dplyr.tidyverse.org/reference/mutate.html)</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`tidyr::pivot_longer()`</span><span class="co">](https://tidyr.tidyverse.org/reference/pivot_longer.html)</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`tidyr::pivot_wider()`</span><span class="co">](https://tidyr.tidyverse.org/reference/pivot_wider.html)</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>Since I'm focusing on how data structures relate to vowel normalization, I'll cover 3 specific normalization procedures:</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lobanov (a.k.a. z-scoring)</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>In terms of tidy data procedures, this is the simplest. All it requires is a <span class="in">`group_by()`</span> and a <span class="in">`mutate()`</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a><span class="fu">### Nearey 2</span></span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>This procedure is a little more complicated, involving "pivoting" our data from wide to long, then long to wide again, using <span class="in">`pivot_longer()`</span> and <span class="in">`pivot_wider()`</span>.</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a><span class="fu">### Watt &amp; Fabricius</span></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>This method requires estimating by-speaker scaling factors (using <span class="in">`group_by()`</span> and <span class="in">`summarise()`</span>) then merging them back onto the original data (with <span class="in">`left_join()`</span>).</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setup</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>To begin with, I'm going to import a few packages:</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`tidyverse`</span>: This is a "metapackage" that imports many different packages that contain functions we'll need, including <span class="in">`ggplot2`</span></span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ggforce`</span>: This is a package that extends some of <span class="in">`ggplot2`</span>'s functionality</span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`khroma`</span>: This is another packages that has many different color palates for <span class="in">`ggplot2`</span>.</span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`joeyr`</span>: This is a package with functions written by Joey Stanley for vowel analysis.</span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>Any time I use a function that's not loaded by the tidyverse, I'll indicate it with the <span class="in">`package::function()`</span> convention.</span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load</span></span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(khroma)</span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("JoeyStanley/joeyr")</span></span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(joeyr)</span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a><span class="co"># set the ggplot2 theme</span></span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a>We also need to load in some data. Here are two tab-delimited files of <span class="co">[</span><span class="ot">Buckeye Corpus</span><span class="co">](https://buckeyecorpus.osu.edu/)</span> speakers whose interviews were run through <span class="co">[</span><span class="ot">FAVE</span><span class="co">](https://github.com/JoFrhwld/FAVE)</span>.</span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a>s01_url <span class="ot">&lt;-</span> <span class="st">"{{&lt; meta website.site-url &gt;}}/content/R/tidy-norm/data/s01.txt"</span></span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a>s03_url <span class="ot">&lt;-</span> <span class="st">"{{&lt; meta website.site-url &gt;}}/content/R/tidy-norm/data/s03.txt"</span></span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-90"><a href="#cb30-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-91"><a href="#cb30-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: data_loc</span></span>
<span id="cb30-92"><a href="#cb30-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb30-93"><a href="#cb30-93" aria-hidden="true" tabindex="-1"></a>s01_url <span class="ot">&lt;-</span> <span class="st">"data/s01.txt"</span></span>
<span id="cb30-94"><a href="#cb30-94" aria-hidden="true" tabindex="-1"></a>s03_url <span class="ot">&lt;-</span> <span class="st">"data/s03.txt"</span></span>
<span id="cb30-95"><a href="#cb30-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-96"><a href="#cb30-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-97"><a href="#cb30-97" aria-hidden="true" tabindex="-1"></a>This code should load these files.</span>
<span id="cb30-98"><a href="#cb30-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-101"><a href="#cb30-101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-102"><a href="#cb30-102" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: read_data</span></span>
<span id="cb30-103"><a href="#cb30-103" aria-hidden="true" tabindex="-1"></a>vowels_orig <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">c</span>(s01_url, s03_url), </span>
<span id="cb30-104"><a href="#cb30-104" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">~</span><span class="fu">read_tsv</span>(.x, <span class="at">col_types=</span><span class="fu">cols</span>(<span class="at">sex =</span> <span class="st">'c'</span>)))</span>
<span id="cb30-105"><a href="#cb30-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-106"><a href="#cb30-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-107"><a href="#cb30-107" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details&gt;</span></span>
<span id="cb30-108"><a href="#cb30-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-109"><a href="#cb30-109" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;</span>What that <span class="in">`map_dfr`</span> thing did:<span class="kw">&lt;/summary&gt;</span></span>
<span id="cb30-110"><a href="#cb30-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-111"><a href="#cb30-111" aria-hidden="true" tabindex="-1"></a>The <span class="in">`map_dfr`</span> function iterated over each url, and applied the function <span class="in">`read_tsv()`</span> to them. I had to tell <span class="in">`read_tsv()`</span> that the column <span class="in">`sex`</span> should be treated as a character data type, since the value <span class="in">`f`</span> gets reinterpreted as <span class="in">`FALSE`</span> otherwise. After reading in each tab-delimited file, <span class="in">`map_dfr()`</span> then combines the results together row-wise, to produce one large data frame.</span>
<span id="cb30-112"><a href="#cb30-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-113"><a href="#cb30-113" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb30-114"><a href="#cb30-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-115"><a href="#cb30-115" aria-hidden="true" tabindex="-1"></a>The variable <span class="in">`vowels_orig`</span> is now one large data frame with both speakers' FAVE output in it. Here's three randomly sampled rows from each speakers' data.</span>
<span id="cb30-116"><a href="#cb30-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-119"><a href="#cb30-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-120"><a href="#cb30-120" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-vowel-orig</span></span>
<span id="cb30-121"><a href="#cb30-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Three randomly sampled rows from each speaker's data"</span></span>
<span id="cb30-122"><a href="#cb30-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap-location: bottom</span></span>
<span id="cb30-123"><a href="#cb30-123" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: markup</span></span>
<span id="cb30-124"><a href="#cb30-124" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">50</span>)</span>
<span id="cb30-125"><a href="#cb30-125" aria-hidden="true" tabindex="-1"></a>vowels_orig <span class="sc">|&gt;</span></span>
<span id="cb30-126"><a href="#cb30-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb30-127"><a href="#cb30-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-128"><a href="#cb30-128" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span>
<span id="cb30-129"><a href="#cb30-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-130"><a href="#cb30-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-131"><a href="#cb30-131" aria-hidden="true" tabindex="-1"></a>FAVE outputs a lot of useful information, but for this tutorial, I want to narrow down our focus to just a few columns</span>
<span id="cb30-132"><a href="#cb30-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-133"><a href="#cb30-133" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`name`</span>: We'll use this as a unique ID for each speaker</span>
<span id="cb30-134"><a href="#cb30-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-135"><a href="#cb30-135" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`word`</span>: It's just good to keep this info around</span>
<span id="cb30-136"><a href="#cb30-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-137"><a href="#cb30-137" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ipa_vclass`</span>: A column indicating each token's vowel class in an IPA-like format</span>
<span id="cb30-138"><a href="#cb30-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-139"><a href="#cb30-139" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`F1`</span>, <span class="in">`F2`</span>: What we're all here for. The first and second formants.</span>
<span id="cb30-140"><a href="#cb30-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-143"><a href="#cb30-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-144"><a href="#cb30-144" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: vowel_focus</span></span>
<span id="cb30-145"><a href="#cb30-145" aria-hidden="true" tabindex="-1"></a>vowels_orig <span class="sc">|&gt;</span></span>
<span id="cb30-146"><a href="#cb30-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, word, ipa_vclass, F1, F2) <span class="ot">-&gt;</span> vowels_focus</span>
<span id="cb30-147"><a href="#cb30-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-148"><a href="#cb30-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-151"><a href="#cb30-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-152"><a href="#cb30-152" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-vowel-focus</span></span>
<span id="cb30-153"><a href="#cb30-153" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "The first few rows of the data we're going to work with"</span></span>
<span id="cb30-154"><a href="#cb30-154" aria-hidden="true" tabindex="-1"></a>vowels_focus <span class="sc">|&gt;</span></span>
<span id="cb30-155"><a href="#cb30-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span></span>
<span id="cb30-156"><a href="#cb30-156" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span>
<span id="cb30-157"><a href="#cb30-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-158"><a href="#cb30-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-159"><a href="#cb30-159" aria-hidden="true" tabindex="-1"></a><span class="fu">## Unnormalized</span></span>
<span id="cb30-160"><a href="#cb30-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-161"><a href="#cb30-161" aria-hidden="true" tabindex="-1"></a>First, let's see how things look when we get our vowel means and plot them unnormalized. I won't go into detail about how the plotting code works (see the LingMethodsHub tutorial on <span class="co">[</span><span class="ot">ggplot2 vowel plots</span><span class="co">](https://lingmethodshub.github.io/content/R/vowel-plots-tutorial/)</span>).</span>
<span id="cb30-162"><a href="#cb30-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-165"><a href="#cb30-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-166"><a href="#cb30-166" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb30-167"><a href="#cb30-167" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Plot code"</span></span>
<span id="cb30-168"><a href="#cb30-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-unnorm1</span></span>
<span id="cb30-169"><a href="#cb30-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb30-170"><a href="#cb30-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb30-171"><a href="#cb30-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Speakers' vowel means in unnormalized F1,F2 space."</span></span>
<span id="cb30-172"><a href="#cb30-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "An F1 by F2 plot of two speakers' unnormalized vowel means."</span></span>
<span id="cb30-173"><a href="#cb30-173" aria-hidden="true" tabindex="-1"></a>vowels_focus <span class="sc">|&gt;</span></span>
<span id="cb30-174"><a href="#cb30-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb30-175"><a href="#cb30-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1, F2), <span class="at">.fns =</span> mean)) <span class="sc">|&gt;</span></span>
<span id="cb30-176"><a href="#cb30-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb30-177"><a href="#cb30-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(F2, F1, <span class="at">color =</span> name))<span class="sc">+</span></span>
<span id="cb30-178"><a href="#cb30-178" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ipa_vclass))<span class="sc">+</span></span>
<span id="cb30-179"><a href="#cb30-179" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_hull</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb30-180"><a href="#cb30-180" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-181"><a href="#cb30-181" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-182"><a href="#cb30-182" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_color_vibrant</span>()<span class="sc">+</span></span>
<span id="cb30-183"><a href="#cb30-183" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_fill_vibrant</span>()</span>
<span id="cb30-184"><a href="#cb30-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-185"><a href="#cb30-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-186"><a href="#cb30-186" aria-hidden="true" tabindex="-1"></a>Here, we see reason number 1 why we'll want to normalize vowels. These two speakers vowel spaced hardly overlap, but the *relative* position of vowel categories inside their spaces are fairly similar. All normalization methods try to do is pinch and scale *appropriately* to get the relative positions of these vowel spaces to overlap.</span>
<span id="cb30-187"><a href="#cb30-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-188"><a href="#cb30-188" aria-hidden="true" tabindex="-1"></a>*Another* reason we might be motivated to normalize our data is because F2 has a much larger range of data than F1. We can more easily see that if we add <span class="in">`coord_fixed()`</span> to the plot.</span>
<span id="cb30-189"><a href="#cb30-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-192"><a href="#cb30-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-193"><a href="#cb30-193" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb30-194"><a href="#cb30-194" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Plot code"</span></span>
<span id="cb30-195"><a href="#cb30-195" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-unnorm2</span></span>
<span id="cb30-196"><a href="#cb30-196" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb30-197"><a href="#cb30-197" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb30-198"><a href="#cb30-198" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Speakers' vowel means in unnormalized F1,F2 space. (fixed coords)"</span></span>
<span id="cb30-199"><a href="#cb30-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "An F1 by F2 plot of two speakers' unnormalized vowel means."</span></span>
<span id="cb30-200"><a href="#cb30-200" aria-hidden="true" tabindex="-1"></a>vowels_focus <span class="sc">|&gt;</span></span>
<span id="cb30-201"><a href="#cb30-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb30-202"><a href="#cb30-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1, F2), <span class="at">.fns =</span> mean)) <span class="sc">|&gt;</span></span>
<span id="cb30-203"><a href="#cb30-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb30-204"><a href="#cb30-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(F2, F1, <span class="at">color =</span> name))<span class="sc">+</span></span>
<span id="cb30-205"><a href="#cb30-205" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ipa_vclass))<span class="sc">+</span></span>
<span id="cb30-206"><a href="#cb30-206" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_hull</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb30-207"><a href="#cb30-207" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-208"><a href="#cb30-208" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-209"><a href="#cb30-209" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_color_vibrant</span>()<span class="sc">+</span></span>
<span id="cb30-210"><a href="#cb30-210" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_fill_vibrant</span>()<span class="sc">+</span></span>
<span id="cb30-211"><a href="#cb30-211" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>()</span>
<span id="cb30-212"><a href="#cb30-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-213"><a href="#cb30-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-214"><a href="#cb30-214" aria-hidden="true" tabindex="-1"></a>The plot is squished because F2 just has that much larger a range of values than F1. Any stats or calculations we do on vowels in the F1$\times$F2 space is going to be dominated by things that happen across F2 vs F1.</span>
<span id="cb30-215"><a href="#cb30-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-216"><a href="#cb30-216" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prepping for normalization</span></span>
<span id="cb30-217"><a href="#cb30-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-218"><a href="#cb30-218" aria-hidden="true" tabindex="-1"></a>In order to get ready for normalization, I'm going to first filter out any vowel tokens that have a $\sqrt{\text{mahalanobis}}$ distance from its vowel class greater than 2.</span>
<span id="cb30-219"><a href="#cb30-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-222"><a href="#cb30-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-223"><a href="#cb30-223" aria-hidden="true" tabindex="-1"></a>vowels_focus <span class="sc">|&gt;</span></span>
<span id="cb30-224"><a href="#cb30-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb30-225"><a href="#cb30-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mahal =</span> joeyr<span class="sc">::</span><span class="fu">tidy_mahalanobis</span>(F1, F2),</span>
<span id="cb30-226"><a href="#cb30-226" aria-hidden="true" tabindex="-1"></a>         <span class="at">mahal_sq =</span> <span class="fu">sqrt</span>(mahal)) <span class="sc">|&gt;</span></span>
<span id="cb30-227"><a href="#cb30-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mahal_sq <span class="sc">&lt;=</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-228"><a href="#cb30-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="ot">-&gt;</span> vowels_inlie</span>
<span id="cb30-229"><a href="#cb30-229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-230"><a href="#cb30-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-231"><a href="#cb30-231" aria-hidden="true" tabindex="-1"></a><span class="fu">## Normalizations</span></span>
<span id="cb30-232"><a href="#cb30-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-233"><a href="#cb30-233" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lobanov a.k.a. z-score</span></span>
<span id="cb30-234"><a href="#cb30-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-235"><a href="#cb30-235" aria-hidden="true" tabindex="-1"></a>The first normalization procedure we'll look at is "Lobanov" normalization <span class="co">[</span><span class="ot">@lobanov</span><span class="co">]</span>. An important thing to know here is that while phoneticians may call this procedure "Lobanov" normalization, the rest of the data analysis world calls it "z-score" or even just "standard score."</span>
<span id="cb30-236"><a href="#cb30-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-237"><a href="#cb30-237" aria-hidden="true" tabindex="-1"></a>The process works like this:</span>
<span id="cb30-238"><a href="#cb30-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-239"><a href="#cb30-239" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Within each speaker's data ⤵️</span>
<span id="cb30-240"><a href="#cb30-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-241"><a href="#cb30-241" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Within each formant ⤵️</span>
<span id="cb30-242"><a href="#cb30-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-243"><a href="#cb30-243" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>subtract the mean of the formant, and divide by the standard deviation of the formant</span>
<span id="cb30-244"><a href="#cb30-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-245"><a href="#cb30-245" aria-hidden="true" tabindex="-1"></a>Since we already a have F1 and F2 separated out into separate columns, this means all we have to do us <span class="in">`group_by()`</span> our vowels data by speaker ID (in <span class="in">`name`</span>), then create our new normalized columns by subtracting the mean and dividing by the standard deviation.</span>
<span id="cb30-246"><a href="#cb30-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-249"><a href="#cb30-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-250"><a href="#cb30-250" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: zscore1</span></span>
<span id="cb30-251"><a href="#cb30-251" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb30-252"><a href="#cb30-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb30-253"><a href="#cb30-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">F1_z =</span> (F1 <span class="sc">-</span> <span class="fu">mean</span>(F1))<span class="sc">/</span><span class="fu">sd</span>(F1),</span>
<span id="cb30-254"><a href="#cb30-254" aria-hidden="true" tabindex="-1"></a>         <span class="at">F2_z =</span> (F2 <span class="sc">-</span> <span class="fu">mean</span>(F2))<span class="sc">/</span><span class="fu">sd</span>(F2)) <span class="ot">-&gt;</span> vowels_score1</span>
<span id="cb30-255"><a href="#cb30-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-256"><a href="#cb30-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-257"><a href="#cb30-257" aria-hidden="true" tabindex="-1"></a>The <span class="in">`group_by(name)`</span> process in this pipeline means that when we calculate <span class="in">`mean(F1)`</span> and <span class="in">`std(F1)`</span> in the next part, those mean and standard deviation values are for each speaker's subset of <span class="in">`vowels_inlie`</span>.</span>
<span id="cb30-258"><a href="#cb30-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-259"><a href="#cb30-259" aria-hidden="true" tabindex="-1"></a>Since z-scoring is so common a thing to do in quantitative analysis, R actually has a built in function, <span class="in">`scale()`</span> that we could use instead of writing the math out ourselves.</span>
<span id="cb30-260"><a href="#cb30-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-263"><a href="#cb30-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-264"><a href="#cb30-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: zscore2</span></span>
<span id="cb30-265"><a href="#cb30-265" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb30-266"><a href="#cb30-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb30-267"><a href="#cb30-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">F1_z =</span> <span class="fu">scale</span>(F1),</span>
<span id="cb30-268"><a href="#cb30-268" aria-hidden="true" tabindex="-1"></a>         <span class="at">F2_z =</span> <span class="fu">scale</span>(F2)) <span class="ot">-&gt;</span> vowels_zscore2</span>
<span id="cb30-269"><a href="#cb30-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-270"><a href="#cb30-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-271"><a href="#cb30-271" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results</span></span>
<span id="cb30-272"><a href="#cb30-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-273"><a href="#cb30-273" aria-hidden="true" tabindex="-1"></a>Here's the results of z-scoring! We've got largely overlapping vowel spaces now. The numeric values of these z-scores tend to run somewhere between -3 and 3 (less extreme for means). Both formants are also on the same scale, which you can see with the plot being roughly square shaped even with <span class="in">`coord_fixed()`</span> being added.</span>
<span id="cb30-274"><a href="#cb30-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-277"><a href="#cb30-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-278"><a href="#cb30-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb30-279"><a href="#cb30-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Plot code"</span></span>
<span id="cb30-280"><a href="#cb30-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-zscore</span></span>
<span id="cb30-281"><a href="#cb30-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb30-282"><a href="#cb30-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb30-283"><a href="#cb30-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Speakers' vowel means in z-scored F1,F2 space. (fixed coords)"</span></span>
<span id="cb30-284"><a href="#cb30-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "An F1 by F2 plot of two speakers' Lobanov normalized vowel means."</span></span>
<span id="cb30-285"><a href="#cb30-285" aria-hidden="true" tabindex="-1"></a>vowels_zscore2 <span class="sc">|&gt;</span></span>
<span id="cb30-286"><a href="#cb30-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb30-287"><a href="#cb30-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1_z, F2_z), <span class="at">.fns =</span> mean)) <span class="sc">|&gt;</span></span>
<span id="cb30-288"><a href="#cb30-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(F2_z, F1_z, <span class="at">color =</span> name))<span class="sc">+</span></span>
<span id="cb30-289"><a href="#cb30-289" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ipa_vclass))<span class="sc">+</span></span>
<span id="cb30-290"><a href="#cb30-290" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_hull</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb30-291"><a href="#cb30-291" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-292"><a href="#cb30-292" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-293"><a href="#cb30-293" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_color_vibrant</span>()<span class="sc">+</span></span>
<span id="cb30-294"><a href="#cb30-294" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_fill_vibrant</span>()<span class="sc">+</span></span>
<span id="cb30-295"><a href="#cb30-295" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>()</span>
<span id="cb30-296"><a href="#cb30-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-297"><a href="#cb30-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-298"><a href="#cb30-298" aria-hidden="true" tabindex="-1"></a><span class="fu">### Nearey (a.k.a. Nearey 2)</span></span>
<span id="cb30-299"><a href="#cb30-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-300"><a href="#cb30-300" aria-hidden="true" tabindex="-1"></a>Next, we'll look at what the vowels package calls "Nearey 2" normalization <span class="co">[</span><span class="ot">@nearey1978</span><span class="co">]</span>. The Nearey 1 procedure is more similar in terms of data code as z-scoring.<span class="ot">[^1]</span> The Nearey 2 procedure works like this:</span>
<span id="cb30-301"><a href="#cb30-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-302"><a href="#cb30-302" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]</span>:</span>
<span id="cb30-303"><a href="#cb30-303" aria-hidden="true" tabindex="-1"></a>    <span class="in">``` r</span></span>
<span id="cb30-304"><a href="#cb30-304" aria-hidden="true" tabindex="-1"></a>    vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb30-305"><a href="#cb30-305" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb30-306"><a href="#cb30-306" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">F1_n =</span> <span class="fu">exp</span>(<span class="fu">log</span>(F1) <span class="sc">-</span> <span class="fu">mean</span>(<span class="fu">log</span>(F1))),</span>
<span id="cb30-307"><a href="#cb30-307" aria-hidden="true" tabindex="-1"></a>             <span class="at">F2_n =</span> <span class="fu">exp</span>(<span class="fu">log</span>(F2) <span class="sc">-</span> <span class="fu">mean</span>(<span class="fu">log</span>(F2))))</span>
<span id="cb30-308"><a href="#cb30-308" aria-hidden="true" tabindex="-1"></a>    <span class="in">```</span></span>
<span id="cb30-309"><a href="#cb30-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-310"><a href="#cb30-310" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Within each speaker ⤵️</span>
<span id="cb30-311"><a href="#cb30-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-312"><a href="#cb30-312" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Convert *all* formant measurements to log-Hz</span>
<span id="cb30-313"><a href="#cb30-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-314"><a href="#cb30-314" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Get the mean log-Hz across all measurements (F1 and F2 *together*)</span>
<span id="cb30-315"><a href="#cb30-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-316"><a href="#cb30-316" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Subtract the mean log-Hz from the log-Hz</span>
<span id="cb30-317"><a href="#cb30-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-318"><a href="#cb30-318" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>"Anti-log" or exponentiate the result</span>
<span id="cb30-319"><a href="#cb30-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-320"><a href="#cb30-320" aria-hidden="true" tabindex="-1"></a>We need to combine F1 and F2 measurements together to get their mean, and this is best achieved in the tidyverse by "pivoting" the data frame from wide to long. We'll take it in steps. In each next step, I'm going to be putting additional tidyverse verbs between the data frame and the line that has <span class="in">`head() |&gt; rmarkdown::paged_table()`</span>, which is just there to provide nice looking output.</span>
<span id="cb30-321"><a href="#cb30-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-322"><a href="#cb30-322" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 1: Focus in on the columns of interest</span></span>
<span id="cb30-323"><a href="#cb30-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-324"><a href="#cb30-324" aria-hidden="true" tabindex="-1"></a>The <span class="in">`vowels_inlie`</span> has data columns for the mahalanobis distance, which I want to drop off for now.</span>
<span id="cb30-325"><a href="#cb30-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-328"><a href="#cb30-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-329"><a href="#cb30-329" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-nearey-focus</span></span>
<span id="cb30-330"><a href="#cb30-330" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "The columns of importance for Neary 2"</span></span>
<span id="cb30-331"><a href="#cb30-331" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb30-332"><a href="#cb30-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, word, ipa_vclass, F1, F2) <span class="sc">|&gt;</span></span>
<span id="cb30-333"><a href="#cb30-333" aria-hidden="true" tabindex="-1"></a>  <span class="co"># more verbs to go here</span></span>
<span id="cb30-334"><a href="#cb30-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span>
<span id="cb30-335"><a href="#cb30-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-336"><a href="#cb30-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-337"><a href="#cb30-337" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 2: Add an ID column</span></span>
<span id="cb30-338"><a href="#cb30-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-339"><a href="#cb30-339" aria-hidden="true" tabindex="-1"></a>When we're pivoting our data long and then wide again, we need to have a column that is a unique id for each vowel observation. I'll create that with <span class="in">`mutate(id = 1:n())`</span> . The <span class="in">`n()`</span> function there is a convenience function that returns the number of rows in each (group) of the data frame.</span>
<span id="cb30-340"><a href="#cb30-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-343"><a href="#cb30-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-344"><a href="#cb30-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-nearey-id</span></span>
<span id="cb30-345"><a href="#cb30-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "The formant data with a token ID for each observation"</span></span>
<span id="cb30-346"><a href="#cb30-346" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb30-347"><a href="#cb30-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, word, ipa_vclass, F1, F2) <span class="sc">|&gt;</span></span>
<span id="cb30-348"><a href="#cb30-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb30-349"><a href="#cb30-349" aria-hidden="true" tabindex="-1"></a>  <span class="co"># more verbs to go here</span></span>
<span id="cb30-350"><a href="#cb30-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span>
<span id="cb30-351"><a href="#cb30-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-352"><a href="#cb30-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-353"><a href="#cb30-353" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 3: Pivot Longer</span></span>
<span id="cb30-354"><a href="#cb30-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-355"><a href="#cb30-355" aria-hidden="true" tabindex="-1"></a>Now, we want to take the F1 and F2 columns, and stack them one on top of each other, which we can do with <span class="in">`pivot_longer()`</span>. This function needs to know at least three things:</span>
<span id="cb30-356"><a href="#cb30-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-357"><a href="#cb30-357" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Which columns are we going to be stacking on top of each other?</span>
<span id="cb30-358"><a href="#cb30-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-359"><a href="#cb30-359" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We pass this information to the <span class="in">`cols=`</span> argument.</span>
<span id="cb30-360"><a href="#cb30-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-361"><a href="#cb30-361" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>How should we keep track of the original column names?</span>
<span id="cb30-362"><a href="#cb30-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-363"><a href="#cb30-363" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We pass this information to <span class="in">`names_to=`</span>.</span>
<span id="cb30-364"><a href="#cb30-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-365"><a href="#cb30-365" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>How should we keep track of the original values from these columns?</span>
<span id="cb30-366"><a href="#cb30-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-367"><a href="#cb30-367" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We pass this information to <span class="in">`values_to=`</span></span>
<span id="cb30-368"><a href="#cb30-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-371"><a href="#cb30-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-372"><a href="#cb30-372" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-nearey-long</span></span>
<span id="cb30-373"><a href="#cb30-373" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "The formant data, pivoted long"</span></span>
<span id="cb30-374"><a href="#cb30-374" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb30-375"><a href="#cb30-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, word, ipa_vclass, F1, F2) <span class="sc">|&gt;</span></span>
<span id="cb30-376"><a href="#cb30-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb30-377"><a href="#cb30-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> F1<span class="sc">:</span>F2, </span>
<span id="cb30-378"><a href="#cb30-378" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"formant"</span>, </span>
<span id="cb30-379"><a href="#cb30-379" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"hz"</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb30-380"><a href="#cb30-380" aria-hidden="true" tabindex="-1"></a>  <span class="co"># more verbs to go here</span></span>
<span id="cb30-381"><a href="#cb30-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">12</span>) <span class="sc">|&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span>
<span id="cb30-382"><a href="#cb30-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-383"><a href="#cb30-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-384"><a href="#cb30-384" aria-hidden="true" tabindex="-1"></a>You can get an idea for what <span class="in">`pivot_longer()`</span> has done by comparing this table (@tbl-nearey-long) to the table before (@tbl-nearey-id). There are two rows in this long table for every row in the wide table. The <span class="in">`name`</span>, <span class="in">`word`</span>, <span class="in">`ipa_vclass`</span>, and <span class="in">`id`</span> values are repeated twice. There's also a new <span class="in">`formant`</span> column, which contains the column names we pivoted longer, and a new <span class="in">`hz`</span> column, which contains the values from the columns we pivoted longer.</span>
<span id="cb30-385"><a href="#cb30-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-386"><a href="#cb30-386" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 4: The actual normalization!</span></span>
<span id="cb30-387"><a href="#cb30-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-388"><a href="#cb30-388" aria-hidden="true" tabindex="-1"></a>Now we can do the actual normalization. The column we'll target is the new <span class="in">`hz`</span> column. We'll log it, subtract the mean log value, then convert it back to its original scale with <span class="in">`exp()`</span>. And don't forget we need to <span class="in">`group_by(name)`</span> first too!</span>
<span id="cb30-389"><a href="#cb30-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-392"><a href="#cb30-392" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-393"><a href="#cb30-393" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-nearey-norm</span></span>
<span id="cb30-394"><a href="#cb30-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "The formant data, pivoted long, and normalized"</span></span>
<span id="cb30-395"><a href="#cb30-395" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb30-396"><a href="#cb30-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, word, ipa_vclass, F1, F2) <span class="sc">|&gt;</span></span>
<span id="cb30-397"><a href="#cb30-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb30-398"><a href="#cb30-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> F1<span class="sc">:</span>F2, </span>
<span id="cb30-399"><a href="#cb30-399" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"formant"</span>, </span>
<span id="cb30-400"><a href="#cb30-400" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"hz"</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-401"><a href="#cb30-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb30-402"><a href="#cb30-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nearey =</span> <span class="fu">exp</span>(<span class="fu">log</span>(hz)<span class="sc">-</span><span class="fu">mean</span>(<span class="fu">log</span>(hz))))<span class="sc">|&gt;</span>  </span>
<span id="cb30-403"><a href="#cb30-403" aria-hidden="true" tabindex="-1"></a>  <span class="co"># more verbs to go here</span></span>
<span id="cb30-404"><a href="#cb30-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">12</span>) <span class="sc">|&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span>
<span id="cb30-405"><a href="#cb30-405" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-406"><a href="#cb30-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-407"><a href="#cb30-407" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 5: Pivoting wide again, for plotting</span></span>
<span id="cb30-408"><a href="#cb30-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-409"><a href="#cb30-409" aria-hidden="true" tabindex="-1"></a>Technically, we're done normalizing the formant data, but in order to make a nice F1$\times$F2 plot, we need to pivot the data wide again.</span>
<span id="cb30-410"><a href="#cb30-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-411"><a href="#cb30-411" aria-hidden="true" tabindex="-1"></a>To do that, we first need to drop the <span class="in">`hz`</span> column, because <span class="in">`pivot_wider()`</span> will go weird if we don't.<span class="ot">[^2]</span> Then, we need to tell <span class="in">`pivot_wider()`</span> the following information:</span>
<span id="cb30-412"><a href="#cb30-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-413"><a href="#cb30-413" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span>But you should try it just to see!</span>
<span id="cb30-414"><a href="#cb30-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-415"><a href="#cb30-415" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Where should it get the names of new columns from?</span>
<span id="cb30-416"><a href="#cb30-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-417"><a href="#cb30-417" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We'll pass this to <span class="in">`names_from=`</span></span>
<span id="cb30-418"><a href="#cb30-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-419"><a href="#cb30-419" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Where should it get the values to put into the new columns from?</span>
<span id="cb30-420"><a href="#cb30-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-421"><a href="#cb30-421" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We'll pass this to <span class="in">`values_from=`</span></span>
<span id="cb30-422"><a href="#cb30-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-423"><a href="#cb30-423" aria-hidden="true" tabindex="-1"></a>After this step, we're done the normalizing process, so I'll assign the result to a variable called <span class="in">`vowels_neary`</span></span>
<span id="cb30-424"><a href="#cb30-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-427"><a href="#cb30-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-428"><a href="#cb30-428" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-neary-wide</span></span>
<span id="cb30-429"><a href="#cb30-429" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Nearey Normalized Vowels, wide again"</span></span>
<span id="cb30-430"><a href="#cb30-430" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb30-431"><a href="#cb30-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, word, ipa_vclass, F1, F2) <span class="sc">|&gt;</span></span>
<span id="cb30-432"><a href="#cb30-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb30-433"><a href="#cb30-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> F1<span class="sc">:</span>F2, </span>
<span id="cb30-434"><a href="#cb30-434" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"formant"</span>, </span>
<span id="cb30-435"><a href="#cb30-435" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"hz"</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-436"><a href="#cb30-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb30-437"><a href="#cb30-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nearey =</span> <span class="fu">exp</span>(<span class="fu">log</span>(hz)<span class="sc">-</span><span class="fu">mean</span>(<span class="fu">log</span>(hz))))<span class="sc">|&gt;</span>  </span>
<span id="cb30-438"><a href="#cb30-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>hz) <span class="sc">|&gt;</span></span>
<span id="cb30-439"><a href="#cb30-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> formant, <span class="at">values_from =</span> nearey) <span class="ot">-&gt;</span> vowels_nearey</span>
<span id="cb30-440"><a href="#cb30-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-441"><a href="#cb30-441" aria-hidden="true" tabindex="-1"></a>vowels_nearey <span class="sc">|&gt;</span></span>
<span id="cb30-442"><a href="#cb30-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span>
<span id="cb30-443"><a href="#cb30-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-444"><a href="#cb30-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-445"><a href="#cb30-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-446"><a href="#cb30-446" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results!</span></span>
<span id="cb30-447"><a href="#cb30-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-450"><a href="#cb30-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-451"><a href="#cb30-451" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb30-452"><a href="#cb30-452" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Plot code"</span></span>
<span id="cb30-453"><a href="#cb30-453" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-neary-norm</span></span>
<span id="cb30-454"><a href="#cb30-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "An F1 by F2 plot of two speakers' Nearey normalized vowel means."</span></span>
<span id="cb30-455"><a href="#cb30-455" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6.5</span></span>
<span id="cb30-456"><a href="#cb30-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb30-457"><a href="#cb30-457" aria-hidden="true" tabindex="-1"></a>vowels_nearey <span class="sc">|&gt;</span></span>
<span id="cb30-458"><a href="#cb30-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb30-459"><a href="#cb30-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1, F2), <span class="at">.fns =</span> mean)) <span class="sc">|&gt;</span></span>
<span id="cb30-460"><a href="#cb30-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(F2, F1, <span class="at">color =</span> name))<span class="sc">+</span></span>
<span id="cb30-461"><a href="#cb30-461" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ipa_vclass))<span class="sc">+</span></span>
<span id="cb30-462"><a href="#cb30-462" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_hull</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb30-463"><a href="#cb30-463" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-464"><a href="#cb30-464" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-465"><a href="#cb30-465" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_color_vibrant</span>()<span class="sc">+</span></span>
<span id="cb30-466"><a href="#cb30-466" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_fill_vibrant</span>()</span>
<span id="cb30-467"><a href="#cb30-467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-468"><a href="#cb30-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-469"><a href="#cb30-469" aria-hidden="true" tabindex="-1"></a>Again, the vowel spaces are largely overlapping. One thing that's not immediately clear from this graph, though, is that this specific approach to Nearey normalization still has a much wider range for F2 than F1, which we can see if we plot it with fixed coordinates.</span>
<span id="cb30-470"><a href="#cb30-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-473"><a href="#cb30-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-474"><a href="#cb30-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb30-475"><a href="#cb30-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Plot code"</span></span>
<span id="cb30-476"><a href="#cb30-476" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-neary-norm-fixed</span></span>
<span id="cb30-477"><a href="#cb30-477" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "An F1 by F2 plot of two speakers' Nearey normalized vowel means. (fixed coordinates)."</span></span>
<span id="cb30-478"><a href="#cb30-478" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6.5</span></span>
<span id="cb30-479"><a href="#cb30-479" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2.5</span></span>
<span id="cb30-480"><a href="#cb30-480" aria-hidden="true" tabindex="-1"></a>vowels_nearey <span class="sc">|&gt;</span></span>
<span id="cb30-481"><a href="#cb30-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb30-482"><a href="#cb30-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1, F2), <span class="at">.fns =</span> mean)) <span class="sc">|&gt;</span></span>
<span id="cb30-483"><a href="#cb30-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(F2, F1, <span class="at">color =</span> name))<span class="sc">+</span></span>
<span id="cb30-484"><a href="#cb30-484" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ipa_vclass))<span class="sc">+</span></span>
<span id="cb30-485"><a href="#cb30-485" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_hull</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb30-486"><a href="#cb30-486" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-487"><a href="#cb30-487" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-488"><a href="#cb30-488" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_color_vibrant</span>()<span class="sc">+</span></span>
<span id="cb30-489"><a href="#cb30-489" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_fill_vibrant</span>()<span class="sc">+</span></span>
<span id="cb30-490"><a href="#cb30-490" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>()</span>
<span id="cb30-491"><a href="#cb30-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-492"><a href="#cb30-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-493"><a href="#cb30-493" aria-hidden="true" tabindex="-1"></a>It gets better if we plot the log of the normalized values<span class="ot">[^3]</span>, but then the vowel space doesn't look like the familiar hertz space.</span>
<span id="cb30-494"><a href="#cb30-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-495"><a href="#cb30-495" aria-hidden="true" tabindex="-1"></a><span class="ot">[^3]: </span>Which is a little silly because that's what we had in the normalization code chunk above, and then we did <span class="in">`exp()`</span> on it.</span>
<span id="cb30-496"><a href="#cb30-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-499"><a href="#cb30-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-500"><a href="#cb30-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb30-501"><a href="#cb30-501" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Plot code"</span></span>
<span id="cb30-502"><a href="#cb30-502" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-neary-log-norm-fixed</span></span>
<span id="cb30-503"><a href="#cb30-503" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Speakers' vowel means in Log Nearey Normalized F1,F2 space (fixed coordinates)."</span></span>
<span id="cb30-504"><a href="#cb30-504" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6.5</span></span>
<span id="cb30-505"><a href="#cb30-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb30-506"><a href="#cb30-506" aria-hidden="true" tabindex="-1"></a>vowels_nearey <span class="sc">|&gt;</span></span>
<span id="cb30-507"><a href="#cb30-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb30-508"><a href="#cb30-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1, F2), <span class="at">.fns =</span> <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">log</span>(.x)))) <span class="sc">|&gt;</span></span>
<span id="cb30-509"><a href="#cb30-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(F2, F1, <span class="at">color =</span> name))<span class="sc">+</span></span>
<span id="cb30-510"><a href="#cb30-510" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ipa_vclass))<span class="sc">+</span></span>
<span id="cb30-511"><a href="#cb30-511" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_hull</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb30-512"><a href="#cb30-512" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-513"><a href="#cb30-513" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-514"><a href="#cb30-514" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_color_vibrant</span>()<span class="sc">+</span></span>
<span id="cb30-515"><a href="#cb30-515" aria-hidden="true" tabindex="-1"></a>    khroma<span class="sc">::</span><span class="fu">scale_fill_vibrant</span>()<span class="sc">+</span></span>
<span id="cb30-516"><a href="#cb30-516" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>()</span>
<span id="cb30-517"><a href="#cb30-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-518"><a href="#cb30-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-519"><a href="#cb30-519" aria-hidden="true" tabindex="-1"></a><span class="fu">### Watt &amp; Fabricius</span></span>
<span id="cb30-520"><a href="#cb30-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-521"><a href="#cb30-521" aria-hidden="true" tabindex="-1"></a>The final normalization method we'll look at, which can't easily be done with a single sequence of tidyverse verbs, is the Watt &amp; Fabricius method <span class="co">[</span><span class="ot">@watt2002</span><span class="co">]</span>. The idea behind the Watt &amp; Fabricius method is to define a vowel space triangle for each speaker, then to scale their formant values to the triangle.</span>
<span id="cb30-522"><a href="#cb30-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-523"><a href="#cb30-523" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 1: Getting the Triangle Points</span></span>
<span id="cb30-524"><a href="#cb30-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-525"><a href="#cb30-525" aria-hidden="true" tabindex="-1"></a>I'll follow the NORM suite and define the points of the triangle like so:</span>
<span id="cb30-526"><a href="#cb30-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-527"><a href="#cb30-527" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Top Left Corner, "beet" point: The F1 of the vowel with the smallest F1, and the F2 of the vowel with the largest F2</span>
<span id="cb30-528"><a href="#cb30-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-529"><a href="#cb30-529" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bottom Corner, "bat" point: The F1 of the vowel with the maximum F1, and the F2 of that same vowel.</span>
<span id="cb30-530"><a href="#cb30-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-531"><a href="#cb30-531" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Top Right Corner, "school" point: F1 = F2 = "beet" point F1.</span>
<span id="cb30-532"><a href="#cb30-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-533"><a href="#cb30-533" aria-hidden="true" tabindex="-1"></a>Here's how you can get those values per speaker:</span>
<span id="cb30-534"><a href="#cb30-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-537"><a href="#cb30-537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-538"><a href="#cb30-538" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-wf-points</span></span>
<span id="cb30-539"><a href="#cb30-539" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "The vowel triangle point values."</span></span>
<span id="cb30-540"><a href="#cb30-540" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb30-541"><a href="#cb30-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb30-542"><a href="#cb30-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1, F2), mean)) <span class="sc">|&gt;</span></span>
<span id="cb30-543"><a href="#cb30-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb30-544"><a href="#cb30-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">beet_f1 =</span> <span class="fu">min</span>(F1),</span>
<span id="cb30-545"><a href="#cb30-545" aria-hidden="true" tabindex="-1"></a>            <span class="at">beet_f2 =</span> <span class="fu">max</span>(F2),</span>
<span id="cb30-546"><a href="#cb30-546" aria-hidden="true" tabindex="-1"></a>            <span class="at">bat_f1 =</span> <span class="fu">max</span>(F1),</span>
<span id="cb30-547"><a href="#cb30-547" aria-hidden="true" tabindex="-1"></a>            <span class="at">bat_f2 =</span> F2[F1 <span class="sc">==</span> <span class="fu">max</span>(F1)]) <span class="sc">|&gt;</span></span>
<span id="cb30-548"><a href="#cb30-548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">school_f1 =</span> beet_f1,</span>
<span id="cb30-549"><a href="#cb30-549" aria-hidden="true" tabindex="-1"></a>         <span class="at">school_f2 =</span> beet_f1) <span class="sc">|&gt;</span></span>
<span id="cb30-550"><a href="#cb30-550" aria-hidden="true" tabindex="-1"></a>  <span class="co"># more verbs to go here</span></span>
<span id="cb30-551"><a href="#cb30-551" aria-hidden="true" tabindex="-1"></a> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span>
<span id="cb30-552"><a href="#cb30-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-553"><a href="#cb30-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-554"><a href="#cb30-554" aria-hidden="true" tabindex="-1"></a>In order to plot these points in an F1$\times$F2 space, we need to do a little <span class="in">`pivot_longer()`</span> and <span class="in">`pivot_wider()`</span> again with the following steps:</span>
<span id="cb30-555"><a href="#cb30-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-556"><a href="#cb30-556" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`pivot_longer()`</span>, to stack the values of the columns between <span class="in">`beet_f1`</span> and <span class="in">`school_f2`</span> on top of each other.</span>
<span id="cb30-557"><a href="#cb30-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-558"><a href="#cb30-558" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Split the point names (e.g. "<span class="in">`beet_f1"`</span>) into separate values (e.g. <span class="in">`"beet"`</span> and <span class="in">`"beet"`</span>) using <span class="in">`separate()`</span>.</span>
<span id="cb30-559"><a href="#cb30-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-560"><a href="#cb30-560" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`pivot_wider()`</span> using the column with <span class="in">`"f1"`</span> and <span class="in">`"f2"`</span> to make the new column names.</span>
<span id="cb30-561"><a href="#cb30-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-564"><a href="#cb30-564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-565"><a href="#cb30-565" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-wf-point-long</span></span>
<span id="cb30-566"><a href="#cb30-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "The vowel triangle point values, long version"</span></span>
<span id="cb30-567"><a href="#cb30-567" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb30-568"><a href="#cb30-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb30-569"><a href="#cb30-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1, F2), mean)) <span class="sc">|&gt;</span></span>
<span id="cb30-570"><a href="#cb30-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb30-571"><a href="#cb30-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">beet_f1 =</span> <span class="fu">min</span>(F1),</span>
<span id="cb30-572"><a href="#cb30-572" aria-hidden="true" tabindex="-1"></a>            <span class="at">beet_f2 =</span> <span class="fu">max</span>(F2),</span>
<span id="cb30-573"><a href="#cb30-573" aria-hidden="true" tabindex="-1"></a>            <span class="at">bat_f1 =</span> <span class="fu">max</span>(F1),</span>
<span id="cb30-574"><a href="#cb30-574" aria-hidden="true" tabindex="-1"></a>            <span class="at">bat_f2 =</span> F2[F1 <span class="sc">==</span> <span class="fu">max</span>(F1)]) <span class="sc">|&gt;</span></span>
<span id="cb30-575"><a href="#cb30-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">school_f1 =</span> beet_f1,</span>
<span id="cb30-576"><a href="#cb30-576" aria-hidden="true" tabindex="-1"></a>         <span class="at">school_f2 =</span> beet_f1) <span class="sc">|&gt;</span></span>
<span id="cb30-577"><a href="#cb30-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> beet_f1<span class="sc">:</span>school_f2, <span class="at">names_to =</span> <span class="st">"var"</span>, <span class="at">values_to =</span> <span class="st">"hz"</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-578"><a href="#cb30-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(var, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"point"</span>, <span class="st">"formant"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb30-579"><a href="#cb30-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> formant, <span class="at">values_from =</span> hz) <span class="ot">-&gt;</span> wf_points</span>
<span id="cb30-580"><a href="#cb30-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-581"><a href="#cb30-581" aria-hidden="true" tabindex="-1"></a>wf_points <span class="sc">|&gt;</span></span>
<span id="cb30-582"><a href="#cb30-582" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span>
<span id="cb30-583"><a href="#cb30-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-584"><a href="#cb30-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-585"><a href="#cb30-585" aria-hidden="true" tabindex="-1"></a>When we plot thee triangle points, we wind up with a plot that looks like a very simplified version of the vowel space from @fig-unnorm1.</span>
<span id="cb30-586"><a href="#cb30-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-589"><a href="#cb30-589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-590"><a href="#cb30-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb30-591"><a href="#cb30-591" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Plot code"</span></span>
<span id="cb30-592"><a href="#cb30-592" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-wf-triangle</span></span>
<span id="cb30-593"><a href="#cb30-593" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb30-594"><a href="#cb30-594" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb30-595"><a href="#cb30-595" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The vowel space triangles for the Watt &amp; Fabricius method"</span></span>
<span id="cb30-596"><a href="#cb30-596" aria-hidden="true" tabindex="-1"></a>wf_points <span class="sc">|&gt;</span></span>
<span id="cb30-597"><a href="#cb30-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(f2, f1))<span class="sc">+</span></span>
<span id="cb30-598"><a href="#cb30-598" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name, <span class="at">color =</span> name), <span class="at">alpha =</span> <span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb30-599"><a href="#cb30-599" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> point))<span class="sc">+</span></span>
<span id="cb30-600"><a href="#cb30-600" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-601"><a href="#cb30-601" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-602"><a href="#cb30-602" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_vibrant</span>()<span class="sc">+</span></span>
<span id="cb30-603"><a href="#cb30-603" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_vibrant</span>()</span>
<span id="cb30-604"><a href="#cb30-604" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-605"><a href="#cb30-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-606"><a href="#cb30-606" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 2: Calculate Scaling Factors</span></span>
<span id="cb30-607"><a href="#cb30-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-608"><a href="#cb30-608" aria-hidden="true" tabindex="-1"></a>With the F1 and F2 of these triangle points, we then calculate scaling factors by just taking the mean of F1 and F2 for each speaker.</span>
<span id="cb30-609"><a href="#cb30-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-612"><a href="#cb30-612" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-613"><a href="#cb30-613" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-wf-scaler</span></span>
<span id="cb30-614"><a href="#cb30-614" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "The Watt &amp; Fabricius scaling factors"</span></span>
<span id="cb30-615"><a href="#cb30-615" aria-hidden="true" tabindex="-1"></a>wf_points <span class="sc">|&gt;</span></span>
<span id="cb30-616"><a href="#cb30-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb30-617"><a href="#cb30-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">S1 =</span> <span class="fu">mean</span>(f1),</span>
<span id="cb30-618"><a href="#cb30-618" aria-hidden="true" tabindex="-1"></a>           <span class="at">S2 =</span> <span class="fu">mean</span>(f2)) <span class="ot">-&gt;</span> wf_scalers</span>
<span id="cb30-619"><a href="#cb30-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-620"><a href="#cb30-620" aria-hidden="true" tabindex="-1"></a>wf_scalers <span class="sc">|&gt;</span></span>
<span id="cb30-621"><a href="#cb30-621" aria-hidden="true" tabindex="-1"></a> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span>
<span id="cb30-622"><a href="#cb30-622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-623"><a href="#cb30-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-624"><a href="#cb30-624" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 3: Merging the scalers onto the original data.</span></span>
<span id="cb30-625"><a href="#cb30-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-626"><a href="#cb30-626" aria-hidden="true" tabindex="-1"></a>Now what we need to do is divide each speaker's F1 and F2 value by these scalers. Right now the speakers' original data is in <span class="in">`vowels_inlie`</span> and the scaling values are in <span class="in">`wf_scalers`</span>, so to do that division, we need to associate these two data frames.</span>
<span id="cb30-627"><a href="#cb30-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-628"><a href="#cb30-628" aria-hidden="true" tabindex="-1"></a>Fortunately, both <span class="in">`vowels_inlie`</span> and <span class="in">`wf_scalers`</span> have a column name in common: the speaker ID column <span class="in">`name`</span>. That means we can merge <span class="in">`wf_scalers`</span> onto <span class="in">`vowels_inlie`</span> with a join operation. There are a few different <span class="in">`*_join()`</span> functions in the tidyverse, and here I'll use <span class="in">`left_join()`</span>.</span>
<span id="cb30-629"><a href="#cb30-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-630"><a href="#cb30-630" aria-hidden="true" tabindex="-1"></a>We need to tell <span class="in">`left_join()`</span> the following information:</span>
<span id="cb30-631"><a href="#cb30-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-632"><a href="#cb30-632" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Which two data frames are we joining together?</span>
<span id="cb30-633"><a href="#cb30-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-634"><a href="#cb30-634" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Since we're piping, the first data frame will appear on the left hand side of <span class="in">`|&gt;`</span>, and the second data frame will be the first argument.</span>
<span id="cb30-635"><a href="#cb30-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-636"><a href="#cb30-636" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Which columns should we use to join the data frames together?</span>
<span id="cb30-637"><a href="#cb30-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-638"><a href="#cb30-638" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`left_join()`</span> will guess and try to join the data together using columns with the same name, but we can explicitly tell it which columns to use with the <span class="in">`by=`</span> argument.</span>
<span id="cb30-639"><a href="#cb30-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-642"><a href="#cb30-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-643"><a href="#cb30-643" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-wf-join</span></span>
<span id="cb30-644"><a href="#cb30-644" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Speakers's scalers merged onto the original data"</span></span>
<span id="cb30-645"><a href="#cb30-645" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb30-646"><a href="#cb30-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(wf_scalers, <span class="at">by =</span> <span class="st">"name"</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-647"><a href="#cb30-647" aria-hidden="true" tabindex="-1"></a>  <span class="co"># more verbs to go here</span></span>
<span id="cb30-648"><a href="#cb30-648" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The group_by here is just to illustrate that each speaker's scalers were</span></span>
<span id="cb30-649"><a href="#cb30-649" aria-hidden="true" tabindex="-1"></a>  <span class="co"># successfully merged</span></span>
<span id="cb30-650"><a href="#cb30-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span> <span class="fu">slice</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span>
<span id="cb30-651"><a href="#cb30-651" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-652"><a href="#cb30-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-653"><a href="#cb30-653" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 4: The actual normalization!</span></span>
<span id="cb30-654"><a href="#cb30-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-655"><a href="#cb30-655" aria-hidden="true" tabindex="-1"></a>Now all we need to do is divide F1 and F2 by their respective scaling factors to get the normalized Watt &amp; Fabricius values.</span>
<span id="cb30-656"><a href="#cb30-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-659"><a href="#cb30-659" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-660"><a href="#cb30-660" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-wf-norm</span></span>
<span id="cb30-661"><a href="#cb30-661" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Speakers' vowels Watt &amp; Fabricius normalized"</span></span>
<span id="cb30-662"><a href="#cb30-662" aria-hidden="true" tabindex="-1"></a>vowels_inlie <span class="sc">|&gt;</span></span>
<span id="cb30-663"><a href="#cb30-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(wf_scalers, <span class="at">by =</span> <span class="st">"name"</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-664"><a href="#cb30-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">F1_wf =</span> F1<span class="sc">/</span>S1,</span>
<span id="cb30-665"><a href="#cb30-665" aria-hidden="true" tabindex="-1"></a>         <span class="at">F2_wf =</span> F2<span class="sc">/</span>S2)<span class="ot">-&gt;</span>vowels_wf</span>
<span id="cb30-666"><a href="#cb30-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-667"><a href="#cb30-667" aria-hidden="true" tabindex="-1"></a>vowels_wf <span class="sc">|&gt;</span></span>
<span id="cb30-668"><a href="#cb30-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span>
<span id="cb30-669"><a href="#cb30-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-670"><a href="#cb30-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-671"><a href="#cb30-671" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results!</span></span>
<span id="cb30-672"><a href="#cb30-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-675"><a href="#cb30-675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-676"><a href="#cb30-676" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-wf-norm</span></span>
<span id="cb30-677"><a href="#cb30-677" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb30-678"><a href="#cb30-678" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Plot code"</span></span>
<span id="cb30-679"><a href="#cb30-679" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb30-680"><a href="#cb30-680" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb30-681"><a href="#cb30-681" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "An F1 by F2 plot of two speakers' Watt &amp; Fabricius normalized vowel means."</span></span>
<span id="cb30-682"><a href="#cb30-682" aria-hidden="true" tabindex="-1"></a>vowels_wf <span class="sc">|&gt;</span></span>
<span id="cb30-683"><a href="#cb30-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, ipa_vclass) <span class="sc">|&gt;</span></span>
<span id="cb30-684"><a href="#cb30-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(F1_wf, F2_wf), <span class="at">.fns =</span> mean)) <span class="sc">|&gt;</span></span>
<span id="cb30-685"><a href="#cb30-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(F2_wf, F1_wf, <span class="at">color =</span> name))<span class="sc">+</span></span>
<span id="cb30-686"><a href="#cb30-686" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ipa_vclass))<span class="sc">+</span></span>
<span id="cb30-687"><a href="#cb30-687" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_hull</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))<span class="sc">+</span></span>
<span id="cb30-688"><a href="#cb30-688" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-689"><a href="#cb30-689" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb30-690"><a href="#cb30-690" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_vibrant</span>()<span class="sc">+</span></span>
<span id="cb30-691"><a href="#cb30-691" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_vibrant</span>()<span class="sc">+</span></span>
<span id="cb30-692"><a href="#cb30-692" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>()</span>
<span id="cb30-693"><a href="#cb30-693" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-694"><a href="#cb30-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-695"><a href="#cb30-695" aria-hidden="true" tabindex="-1"></a>Again, we've got largely overlapping vowel spaces, and since F1 and F2 were normalized separately, they've got very comparable data ranges.</span>
<span id="cb30-696"><a href="#cb30-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-697"><a href="#cb30-697" aria-hidden="true" tabindex="-1"></a><span class="fu">## Final thoughts</span></span>
<span id="cb30-698"><a href="#cb30-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-699"><a href="#cb30-699" aria-hidden="true" tabindex="-1"></a>There there has been a *lot* written about vowel normalization methods, and I've barely covered most of the relevant topics discussed in the literature. For example:</span>
<span id="cb30-700"><a href="#cb30-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-701"><a href="#cb30-701" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>How well do these methods correspond to what *listeners* actually do when hearing people with different vowel spaces?</span>
<span id="cb30-702"><a href="#cb30-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-703"><a href="#cb30-703" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Should we really be plotting and analyzing formants in Hz, or should the by converted to a psychoacoustic dimension, like Mel or Bark?</span>
<span id="cb30-704"><a href="#cb30-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-705"><a href="#cb30-705" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Which method is the "Best"? What do we want a method to be "Best" *at*?</span>
<span id="cb30-706"><a href="#cb30-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-707"><a href="#cb30-707" aria-hidden="true" tabindex="-1"></a>Instead, I've covered some of most commonly used normalization methods, and also tried to provide an outline of how these methods correspond to specific data frame operations in the tidyverse.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center"><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>